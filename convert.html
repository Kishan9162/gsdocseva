<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Favicon (root icons take priority) -->
  <link rel="icon" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <meta name="msapplication-TileImage" content="/favicon-32.png">
  <!-- Backwards-compatible image reference -->
  <link rel="icon" href="images/gs-logo.png" sizes="any">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- ‚òÖ #1 SEO Meta Tags for Image Format Converter -->
<title>Free Image Converter | JPG PNG WebP GIF BMP PDF Converter Online - GS DocSeva</title>
<meta name="description" content="‚òÖ Free Image Format Converter - Global Tool for USA, UK, Canada, Australia, India. Convert JPG to PNG, PNG to JPG, WebP, GIF, BMP, PDF. Perfect for passport, visa, govt forms. Instant conversion in browser. No watermark.">
<meta name="keywords" content="image converter, format converter, jpg to png, png to jpg, webp converter, gif converter, bmp converter, pdf to image, signature cleaner, signature scanner, convert image format, image format changer, photo converter, picture converter, online image converter free, jpg png converter, webp to jpg, png to webp, signature background remover, clean signature, pdf to jpg, pdf to png, image ko convert kaise kare, photo format kaise badle, signature saaf kaise kare, pdf ko image me kaise badle">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://www.gsdocseva.com/convert.html">
<meta property="og:title" content="Free Image Converter | JPG PNG WebP GIF BMP PDF Converter - GS DocSeva">
<meta property="og:description" content="Convert images between any format - JPG, PNG, WebP, GIF, BMP. Clean signature backgrounds. Convert PDF to images. Free & private in your browser.">
<meta property="og:image" content="https://www.gsdocseva.com/images/gs-logo-horizontal.png">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://www.gsdocseva.com/convert.html">
<meta property="twitter:title" content="Free Image Converter | JPG PNG WebP GIF BMP PDF Converter - GS DocSeva">
<meta property="twitter:description" content="Convert images between any format instantly. Clean signatures. PDF to image converter. Free & secure.">
<meta property="twitter:image" content="https://www.gsdocseva.com/images/gs-logo-horizontal.png">

<!-- Additional SEO -->
<meta name="robots" content="index, follow">
<meta name="language" content="English">
<meta name="revisit-after" content="7 days">
<meta name="author" content="GS DocSeva">
<meta name="geo.region" content="IN">
<meta name="geo.placename" content="India">
<link rel="canonical" href="https://www.gsdocseva.com/convert.html">

<!-- jsPDF library for PDF conversion -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<!-- GIF.js library for GIF creation -->
<script src="https://cdn.jsdelivr.net/npm/gif.js@0.2.0/dist/gif.js"></script>

<link rel="stylesheet" href="style.min.css">
<style>
  * {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    box-sizing: border-box;
  }

  html, body {
    overflow-x: hidden;
    max-width: 100vw;
  }

  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
    margin: 0;
    padding: 0;
    background: #f9fafb;
  }

  .converter-container {
    max-width: 100%;
    margin: 0;
    padding: 0;
  }

  .converter-section {
    background: white;
    padding: 12px;
    border-radius: 10px;
    margin: 8px auto;
    box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    border: 1px solid #e5e7eb;
    max-width: 95%;
    width: 100%;
  }

  .converter-section h2 {
    color: #1f2937;
    margin: 0 0 10px 0;
    font-size: 17px;
    font-weight: 700;
  }

  .upload-area {
    border: 2px dashed #d1d5db;
    padding: 20px 15px;
    text-align: center;
    border-radius: 8px;
    background: #f9fafb;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .upload-area:hover {
    border-color: #4f46e5;
    background: #f3f4f6;
  }

  /* Keep inputs available for programmatic .click() (Edge requires not display:none) */
  .upload-area input,
  input.hidden-offscreen {
    position: absolute;
    left: -9999px;
    width: 1px;
    height: 1px;
    overflow: hidden;
  }

  .upload-area p {
    font-size: 14px;
    font-weight: 600;
    color: #1f2937;
    margin-bottom: 6px;
  }

  .upload-area small {
    color: #6b7280;
    font-size: 12px;
  }

  .preview {
    max-width: 100%;
    max-height: 140px;
    object-fit: contain;
    border-radius: 6px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    margin: 6px 0;
  }

  /* Strong responsive overrides to prevent clipping on small viewports */
  .converter-container, .converter-section, .three-column-grid {
    min-width: 0 !important;
    width: 100% !important;
    box-sizing: border-box !important;
    overflow: visible !important;
  }

  /* Ensure images and svg scale down on narrow screens */
  img, svg {
    max-width: 100% !important;
    height: auto !important;
  }

  /* Prevent any children from forcing horizontal scroll */
  .converter-section * {
    min-width: 0 !important;
    word-break: break-word !important;
  }

  .controls {
    margin: 12px 0;
    display: flex;
    gap: 10px;
    flex-direction: column;
  }

  select {
    padding: 9px 12px;
    border: 2px solid #e0e7ff;
    border-radius: 6px;
    font-size: 13px;
    font-weight: 500;
    width: 100%;
  }

  .btn {
    width: 100%;
    padding: 10px;
    font-size: 13px;
    font-weight: 700;
    border-radius: 8px;
    border: none;
    background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
    color: white;
    cursor: pointer;
    transition: all 0.3s;
  }

  .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
  }

  .btn.reset {
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
  }

  @media(max-width: 768px) {
    .converter-section {
      padding: 10px;
    }
  }

  .double-preview {
    display: flex;
    gap: 14px;
    flex-wrap: wrap;
    align-items: center;
  }

  /* Preview label pill */
  .preview-label {
    display: inline-block;
    background: #eef2ff;
    color: #1f2937;
    font-weight: 700;
    font-size: 12px;
    padding: 6px 10px;
    border-radius: 999px;
    margin-bottom: 8px;
  }

  .preview-placeholder {
    font-size: 12px;
    color: #94a3b8;
    text-align: center;
  }

  /* Responsive grid collapse for mobile */
  @media (max-width: 900px) {
    .converter-section > div > div[style*="grid-template-columns"] {
      grid-template-columns: 1fr !important;
    }
    .preview { max-height: 160px; }
  }

  /* Three-column grid used in converter page */
  .three-column-grid {
    display: grid;
    grid-template-columns: 360px 0.8fr 360px;
    gap: 15px;
    align-items: start;
  }

  @media (max-width: 900px) {
    .three-column-grid {
      grid-template-columns: 1fr;
      grid-auto-flow: row;
      gap: 12px;
    }

    /* On mobile, show the upload column first for better UX (move middle column to top) */
    .three-column-grid { display: flex; flex-direction: column; }
    .three-column-grid > div:nth-child(2) { order: -1; }
    .three-column-grid > div { width: 100%; }
    .upload-area { padding: 12px; }
    .preview { max-height: 160px; }
  }

  /* Signature card responsive ordering */
  .signature-pdf-grid { grid-template-columns: 1fr 1fr; }

  @media (max-width: 900px) {
    .signature-pdf-grid { grid-template-columns: 1fr !important; }
    .signature-card .upload-area { display: flex; flex-direction: column; align-items: stretch; }
    .signature-card .sig-controls { order: 1; }
    .signature-card #signaturePreview, .signature-card #signatureCleanPreview { order: 2; }
    .signature-card .sig-controls .btn { width: 100%; }
    .signature-card .upload-area img { max-height: 180px; width: 100%; object-fit: contain; }
  }

  /* Signature-specific responsive tweaks */
  #signaturePreview, #signatureCleanPreview {
    max-width: 100%;
    height: auto;
    display: block;
    margin: 8px 0 0 0;
  }

  #signatureOutput { font-size: 13px; color: #374151; }

  #sigThreshold { width: 100%; }
  #sigLevelLabel { display: inline-block; margin-left: 8px; font-weight:700; }

  /* Make signature and PDF choose buttons full-width on small screens */
  @media (max-width: 600px) {
    #chooseSigBtn, #choosePdfBtn, #chooseImageBtn { width: 100%; }
    .upload-area { padding: 10px; }
    .controls { gap: 8px; }
  }

  /* Maintenance Notice */
  .maintenance-notice {
    background: #fff3cd;
    color: #856404;
    border: 1px solid #ffeeba;
    border-radius: 8px;
    padding: 12px;
    margin: 16px 0;
    text-align: center;
    font-size: 15px;
    font-weight: 600;
    z-index: 9999;
  }
</style>
<style>
  /* Page-specific overrides to match global site theme */
  .nav-container { height: 96px; }
  .nav-logo { height: 110px; max-width: 520px; object-fit: contain; }
  .hero-section { padding: 60px 20px; border-radius: 12px; }
  .cta-buttons { gap: 14px; margin-bottom: 34px; }
  .upload-area { border-radius: 12px; box-shadow: 0 6px 16px rgba(15,23,42,0.04); }
  .preview { max-height: 180px; border-radius: 10px; }
  .animated-gradient { opacity: 0.03 !important; }
  @media (max-width: 900px) {
    .nav-container { height: 72px; }
    .nav-logo { height: 72px; }
    .cta-buttons .cta-btn { width: 100%; padding: 14px 20px; }
  }
</style>
</head>
<body>

<!-- Maintenance notice removed -->

<!-- Navigation Bar -->
<nav>
  <div class="nav-container">
    <a href="index.html" class="nav-brand">
      <img src="images/gs-logo-horizontal.png" alt="GS DocSeva" class="nav-logo" onerror="this.style.display='none'" style="max-height:110px; width:auto;">
    </a>
    <button class="nav-toggle">
      <span></span>
      <span></span>
      <span></span>
    </button>
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="exam-prep.html">Exam Prep</a></li>
      <li><a href="resize.html">Resize</a></li>
      <li><a href="remove-bg.html">Remove BG</a></li>
      <li><a href="convert.html" class="active">Convert</a></li>
      <li><a href="privacy-policy.html">Privacy</a></li>
    </ul>
  </div>
</nav>

<header style="margin: 10px 0 8px 0; text-align: center;">
  <h1 style="margin: 0 0 4px 0; font-size: 28px; font-weight: 800; color: #000000;">Convert Any Image Format</h1>
  <p style="margin: 0; font-size: 14px; color: #374151;">Change your image to <strong style="color: #000000;">JPG ‚Ä¢ PNG ‚Ä¢ WebP ‚Ä¢ GIF ‚Ä¢ BMP ‚Ä¢ PDF</strong> in seconds</p>
  
  <!-- How to Convert - Compact Version -->
  <div style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); padding: 8px 16px; border-radius: 8px; margin: 8px auto 0; max-width: 800px; border: 1px solid #bae6fd;">
    <div style="display: flex; align-items: center; justify-content: center; gap: 20px; flex-wrap: wrap; font-size: 12px; color: #0c4a6e; font-weight: 600;">
      <span>1Ô∏è‚É£ <strong>Upload</strong></span>
      <span style="color: #0ea5e9;">‚Üí</span>
      <span>2Ô∏è‚É£ <strong>Select Format</strong></span>
      <span style="color: #0ea5e9;">‚Üí</span>
      <span>3Ô∏è‚É£ <strong>Convert</strong></span>
      <span style="color: #0ea5e9;">‚Üí</span>
      <span>4Ô∏è‚É£ <strong>Download</strong></span>
    </div>
  </div>
</header>

<div class="converter-container">
  <!-- Image Format Converter -->
  <div class="converter-section">

    <!-- 3-Column Layout -->
    <div class="three-column-grid">
      
      <!-- Column 1: Preview (Left) -->
      <div>
        <div style="background: #ffffff; padding: 12px; border-radius: 8px; border: 1px solid #e2e8f0;">
          <h3 style="font-size: 12px; margin: 0 0 12px 0; font-weight: 600; color: #1f2937; text-align: center;">Preview</h3>
          
          <!-- Original -->
          <div>
            <div style="background: #f8fafc; border-radius: 8px; padding: 12px; min-height: 180px; display: flex; align-items: center; justify-content: center; border: 2px dashed #cbd5e1; position: relative;">
              <div style="position: absolute; top: 8px; left: 12px; z-index: 3;"><span class="preview-label">Original</span></div>
              <img id="imagePreview" alt="" style="max-width:100%; max-height: 170px; object-fit: contain; border-radius: 6px; display: none; position: relative; z-index: 2;">
              <span id="imagePlaceholder" style="font-size: 10px; color: #94a3b8; text-align: center; position: absolute;">Image will appear<br>after upload</span>
            </div>
            <div id="imageInfo" style="margin-top:6px; font-size:11px; color: #64748b; text-align: center; font-weight: 600;">-</div>
          </div>
        </div>
      </div>

      <!-- Column 2: Upload (Middle) -->
      <div>
        <div class="upload-area upload-lower" id="imageUploadArea">
          <div style="font-size: 32px; margin-bottom: 5px;">
            <svg width="32" height="32" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: inline-block;">
              <rect x="8" y="16" width="48" height="40" rx="4" fill="#e0e7ff" stroke="#667eea" stroke-width="2"/>
              <path d="M20 36L28 28L36 36L44 28L52 36" stroke="#667eea" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
              <circle cx="22" cy="26" r="3" fill="#fbbf24"/>
              <path d="M32 8L32 24M32 8L28 12M32 8L36 12" stroke="#10b981" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
              <circle cx="32" cy="24" r="2" fill="#10b981"/>
            </svg>
          </div>
          <p>Upload Image</p>
          <small>JPG, PNG, WebP, GIF, BMP</small>
          <button type="button" id="chooseImageBtn" class="btn-choose">Choose file</button>
          <input type="file" id="imageFile" class="hidden-offscreen" accept="image/jpeg,image/jpg,image/png,image/webp,image/gif,image/bmp,image/tiff,image/svg+xml">
        </div>
        
        <!-- Conversion Indicator -->
        <div id="conversionIndicator" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border: 2px solid #f59e0b; border-radius: 8px; padding: 10px; margin-top: 10px; display: none;">
          <div style="display: flex; align-items: center; justify-content: space-between; gap: 8px;">
            <div style="flex: 1; text-align: center;">
              <div style="font-size: 9px; color: #78350f; font-weight: 600; margin-bottom: 3px;">Current Format</div>
              <div id="currentFormat" style="background: #ffffff; padding: 8px 12px; border-radius: 6px; font-size: 13px; font-weight: 700; color: #ea580c; border: 2px solid #fb923c;">-</div>
            </div>
            <div style="font-size: 20px; color: #f59e0b;">‚Üí</div>
            <div style="flex: 1; text-align: center;">
              <div style="font-size: 9px; color: #78350f; font-weight: 600; margin-bottom: 3px;">Convert To</div>
              <div id="targetFormat" style="background: #ffffff; padding: 8px 12px; border-radius: 6px; font-size: 13px; font-weight: 700; color: #16a34a; border: 2px solid #4ade80;">-</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Column 3: Settings (Right) -->
      <div>
        <div style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); padding: 12px; border-radius: 8px; border: 2px solid #0ea5e9; box-shadow: 0 4px 12px rgba(14, 165, 233, 0.15);">
          
          <!-- Highlight Banner -->
          <div style="background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%); padding: 8px 10px; border-radius: 6px; margin-bottom: 12px; text-align: center;">
            <div style="font-size: 11px; color: #ffffff; font-weight: 700; margin-bottom: 3px;">üîÑ Format Converter</div>
            <div style="font-size: 9px; color: #e0f2fe; font-weight: 500;">JPG ‚Üî PNG ‚Üî WebP ‚Üî GIF ‚Üî BMP ‚Üî PDF</div>
          </div>
          
          <div style="margin-bottom: 10px;">
            <label style="font-size: 12px; font-weight: 700; color: #0c4a6e; display: block; margin-bottom: 8px;">Select Output Format</label>
            <select id="imageFormat" onchange="updateTargetFormat()" style="width: 100%; padding: 12px 10px; font-size: 15px; border: 2px solid #0ea5e9; border-radius: 6px; font-weight: 600; color: #0c4a6e; line-height: 1.5;">
              <option value="jpg" style="padding: 8px; font-size: 15px;">üì∑ JPG</option>
              <option value="jpeg" style="padding: 8px; font-size: 15px;">üì∑ JPEG</option>
              <option value="png" style="padding: 8px; font-size: 15px;">üñºÔ∏è PNG</option>
              <option value="webp" style="padding: 8px; font-size: 15px;">üåê WebP</option>
              <option value="gif" style="padding: 8px; font-size: 15px;">üéûÔ∏è GIF</option>
              <option value="bmp" style="padding: 8px; font-size: 15px;">üñºÔ∏è BMP</option>
              <option value="pdf" style="padding: 8px; font-size: 15px;">üìÑ PDF</option>
            </select>
          </div>

          <div class="controls">
            <button class="btn" onclick="convertImage()">üíæ Convert & Download</button>
            <button class="btn" onclick="shareImageWhatsApp()" style="background: linear-gradient(135deg, #25D366 0%, #128C7E 100%); display: flex; align-items: center; justify-content: center; gap: 6px;">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z" fill="white"/>
                <path d="M20.52 3.449C18.24 1.245 15.24 0 12.045 0 5.463 0 .104 5.334.101 11.893c0 2.096.549 4.14 1.595 5.945L0 24l6.335-1.652c1.746.943 3.71 1.444 5.71 1.447h.006c6.585 0 11.946-5.336 11.949-11.896 0-3.176-1.24-6.165-3.48-8.45zm-8.475 18.298c-1.776 0-3.517-.475-5.028-1.37l-.36-.214-3.738.975 1.005-3.645-.237-.374c-.975-1.548-1.49-3.337-1.49-5.188.003-5.358 4.394-9.72 9.798-9.72 2.618.001 5.079 1.016 6.928 2.856 1.85 1.84 2.869 4.286 2.866 6.892-.003 5.359-4.395 9.722-9.744 9.722z" fill="white"/>
              </svg>
              Share on WhatsApp
            </button>
            <button class="btn reset" onclick="resetImage()">üîÑ Reset</button>
          </div>

          <div id="imageOutput"></div>
        </div>
      </div>
    </div>
  </div>

  <p style="margin-top: 30px; text-align: center;">
    <a href="index.html" style="color: #6366f1; text-decoration: none; font-weight: 500;">‚Üê Back to Home</a>
  </p>
</div>

<!-- Signature & PDF quick cards removed per request (separate pages exist) -->

<!-- SEO Content Section -->
<div style="max-width: 1200px; margin: 40px auto 20px; padding: 0 20px;">
  <div style="background: #ffffff; padding: 20px; border-radius: 8px; border: 1px solid #e5e7eb;">
    
    <h2 style="font-size: 22px; color: #000000; margin: 0 0 14px 0; font-weight: 700; text-align: center;">Free Image Format Converter</h2>
    
    <!-- Feature Cards -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 10px; margin-bottom: 12px;">
      <div style="background: #f9fafb; padding: 12px; border-radius: 6px; border: 1px solid #e5e7eb;">
        <h3 style="font-size: 15px; color: #000000; margin: 0 0 6px 0; font-weight: 700;">Multi-Format Support</h3>
        <p style="font-size: 13px; color: #4b5563; margin: 0; line-height: 1.5;">Convert <strong>JPG, PNG, WebP, GIF, BMP</strong> formats instantly.</p>
      </div>
      
      <div style="background: #f9fafb; padding: 12px; border-radius: 6px; border: 1px solid #e5e7eb;">
        <h3 style="font-size: 15px; color: #000000; margin: 0 0 6px 0; font-weight: 700;">Fast & Easy</h3>
        <p style="font-size: 13px; color: #4b5563; margin: 0; line-height: 1.5;">Upload, select format, download instantly. <strong>No registration</strong>.</p>
      </div>
      
      <div style="background: #f9fafb; padding: 12px; border-radius: 6px; border: 1px solid #e5e7eb;">
        <h3 style="font-size: 15px; color: #000000; margin: 0 0 6px 0; font-weight: 700;">100% Private</h3>
        <p style="font-size: 13px; color: #4b5563; margin: 0; line-height: 1.5;">All conversion in browser. <strong>Images never uploaded</strong>.</p>
      </div>
    </div>
    
    
    <!-- Popular Uses -->
    <div style="background: #f9fafb; padding: 14px; border-radius: 6px; border: 1px solid #e5e7eb; margin-bottom: 10px;">
      <h3 style="font-size: 16px; color: #000000; margin: 0 0 10px 0; font-weight: 700;">Popular Conversions</h3>
      <p style="font-size: 13px; color: #374151; margin: 0; line-height: 1.7;">
        <strong>PNG to JPG</strong> - Smaller files for web<br>
        <strong>JPG to PNG</strong> - Add transparency<br>
        <strong>WebP</strong> - Modern format, 30% smaller<br>
        <strong>GIF to JPG/PNG</strong> - Better quality<br>
        <strong>BMP</strong> - Reduce file size<br>
        <strong>PDF</strong> - Convert images to PDF documents
      </p>
    </div>
    
    <!-- Use Cases -->
    <div style="background: #f9fafb; padding: 14px; border-radius: 6px; border: 1px solid #e5e7eb; margin-bottom: 10px;">
      <h3 style="font-size: 16px; color: #000000; margin: 0 0 10px 0; font-weight: 700;">Perfect For</h3>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
        <div>
          <p style="font-size: 13px; color: #374151; margin: 0; line-height: 1.6;">
            üìÑ <strong>Government Forms</strong><br>
            <span style="color: #6b7280;">Convert to required formats for exam applications</span>
          </p>
        </div>
        <div>
          <p style="font-size: 13px; color: #374151; margin: 0; line-height: 1.6;">
            üíº <strong>Job Applications</strong><br>
            <span style="color: #6b7280;">Format photos for resume and portfolios</span>
          </p>
        </div>
        <div>
          <p style="font-size: 13px; color: #374151; margin: 0; line-height: 1.6;">
            üåê <strong>Website Optimization</strong><br>
            <span style="color: #6b7280;">Reduce file size for faster loading</span>
          </p>
        </div>
        <div>
          <p style="font-size: 13px; color: #374151; margin: 0; line-height: 1.6;">
            üìß <strong>Email Attachments</strong><br>
            <span style="color: #6b7280;">Compress images to meet size limits</span>
          </p>
        </div>
      </div>
    </div>
    
    <!-- Technical Features -->
    <div style="background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); padding: 14px; border-radius: 6px; border: 1px solid #bfdbfe;">
      <h3 style="font-size: 16px; color: #000000; margin: 0 0 10px 0; font-weight: 700;">Technical Features</h3>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 12px; font-size: 13px; color: #1e40af;">
        <div style="display: flex; align-items: start; gap: 6px;">
          <span style="font-weight: 700; color: #3b82f6;">‚úì</span>
          <span><strong>Client-Side Processing</strong> - No server uploads, complete privacy</span>
        </div>
        <div style="display: flex; align-items: start; gap: 6px;">
          <span style="font-weight: 700; color: #3b82f6;">‚úì</span>
          <span><strong>High Quality Output</strong> - Maintains image quality during conversion</span>
        </div>
        <div style="display: flex; align-items: start; gap: 6px;">
          <span style="font-weight: 700; color: #3b82f6;">‚úì</span>
          <span><strong>No File Size Limit</strong> - Convert images up to 10MB instantly</span>
        </div>
        <div style="display: flex; align-items: start; gap: 6px;">
          <span style="font-weight: 700; color: #3b82f6;">‚úì</span>
          <span><strong>Batch Compatible</strong> - Convert multiple images one by one</span>
        </div>
        <div style="display: flex; align-items: start; gap: 6px;">
          <span style="font-weight: 700; color: #3b82f6;">‚úì</span>
          <span><strong>Cross-Platform</strong> - Works on desktop, tablet, and mobile</span>
        </div>
        <div style="display: flex; align-items: start; gap: 6px;">
          <span style="font-weight: 700; color: #3b82f6;">‚úì</span>
          <span><strong>Modern Browser Support</strong> - Compatible with Chrome, Firefox, Safari, Edge</span>
        </div>
      </div>
    </div>
    
  </div>
</div>

<!-- Impactful Bottom Section -->
<div style="background: linear-gradient(135deg, #000000 0%, #1f2937 100%); padding: 30px 20px; margin-top: 30px;">
  <div style="max-width: 900px; margin: 0 auto; text-align: center;">
    <h2 style="color: #ffffff; font-size: 26px; font-weight: 800; margin: 0 0 12px 0; letter-spacing: 0.5px;">Why Choose Our Image Converter?</h2>
    <p style="color: #d1d5db; font-size: 15px; line-height: 1.7; margin: 0 0 20px 0; max-width: 700px; margin-left: auto; margin-right: auto;">
      Convert images <strong style="color: #ffffff;">instantly</strong> without uploading to any server. Your images stay <strong style="color: #ffffff;">100% private</strong> on your device. Fast, secure, and completely <strong style="color: #ffffff;">free</strong> - the perfect tool for students, professionals, and everyone.
    </p>
    <div style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; margin-top: 25px;">
      <div style="text-align: center;">
        <div style="font-size: 32px; font-weight: 900; color: #3b82f6; margin-bottom: 5px;">100%</div>
        <div style="color: #9ca3af; font-size: 13px; font-weight: 600;">FREE FOREVER</div>
      </div>
      <div style="text-align: center;">
        <div style="font-size: 32px; font-weight: 900; color: #10b981; margin-bottom: 5px;">7+</div>
        <div style="color: #9ca3af; font-size: 13px; font-weight: 600;">FORMATS</div>
      </div>
      <div style="text-align: center;">
        <div style="font-size: 32px; font-weight: 900; color: #f59e0b; margin-bottom: 5px;">0</div>
        <div style="color: #9ca3af; font-size: 13px; font-weight: 600;">ADS & SIGNUP</div>
      </div>
      <div style="text-align: center;">
        <div style="font-size: 32px; font-weight: 900; color: #ef4444; margin-bottom: 5px;">‚àû</div>
        <div style="color: #9ca3af; font-size: 13px; font-weight: 600;">UNLIMITED USE</div>
      </div>
    </div>
  </div>
</div>

<!-- SEO Content Section -->
<div style="background: #f9fafb; padding: 40px 20px; margin-top: 50px; border-top: 1px solid #e5e7eb;">
  <div style="max-width: 1200px; margin: 0 auto;">
    <div style="display: none;"><!-- SEO Keywords for International Search -->
      image format converter online, convert JPG to PNG, PNG to JPG converter, image to PDF, convert WebP, 
      photo format changer free, picture converter tool, convert image format online, batch image converter, 
      JPG PNG WebP GIF BMP converter, free image conversion, no watermark converter, instant format change, 
      convert photo for passport, convert image for visa, format converter for documents, government form image converter, 
      USA image converter, UK photo format, Canada image tool, Australia format converter, India photo converter, 
      international format converter, worldwide image tool, global photo format changer, convert for any country, 
      high quality image converter, lossless conversion, maintain image quality, professional converter, 
      ‡§á‡§Æ‡•á‡§ú ‡§´‡•â‡§∞‡•ç‡§Æ‡•á‡§ü ‡§¨‡§¶‡§≤‡•á‡§Ç, JPG ‡§∏‡•á PNG, PNG ‡§∏‡•á JPG, ‡§´‡•ã‡§ü‡•ã ‡§ï‡§®‡•ç‡§µ‡§∞‡•ç‡§ü‡§∞ ‡§ë‡§®‡§≤‡§æ‡§á‡§®, ‡§á‡§Æ‡•á‡§ú ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡•á‡§Ç, 
      ‡§´‡•â‡§∞‡•ç‡§Æ‡•á‡§ü ‡§ö‡•á‡§Ç‡§ú‡§∞ ‡§ü‡•Ç‡§≤, ‡§°‡•â‡§ï‡•ç‡§Ø‡•Ç‡§Æ‡•á‡§Ç‡§ü ‡§á‡§Æ‡•á‡§ú ‡§ï‡§®‡•ç‡§µ‡§∞‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç, ‡§¨‡§ø‡§®‡§æ ‡§ï‡•ç‡§µ‡§æ‡§≤‡§ø‡§ü‡•Ä ‡§ñ‡•ã‡§è ‡§ï‡§®‡•ç‡§µ‡§∞‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç
    </div>
    
    <h2 style="font-size: 20px; font-weight: 700; color: #1f2937; text-align: center; margin-bottom: 20px;">Free Image Format Converter - All Countries</h2>
    <p style="font-size: 13px; color: #64748b; text-align: center; max-width: 800px; margin: 0 auto 30px; line-height: 1.6;">
      Convert between JPG, PNG, WebP, GIF, BMP, and PDF formats. Used worldwide in USA, UK, Canada, Australia, India for passport photos, visa applications, government forms, and official documents.
    </p>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
      <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #e5e7eb;">
        <h3 style="font-size: 14px; font-weight: 700; color: #1f2937; margin: 0 0 8px 0;">üîÑ All Formats Supported</h3>
        <p style="font-size: 12px; color: #64748b; margin: 0; line-height: 1.5;">JPG, PNG, WebP, GIF, BMP, PDF. Convert to any format required by government forms, visa applications, or job portals worldwide.</p>
      </div>
      <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #e5e7eb;">
        <h3 style="font-size: 14px; font-weight: 700; color: #1f2937; margin: 0 0 8px 0;">üåè International Compatibility</h3>
        <p style="font-size: 12px; color: #64748b; margin: 0; line-height: 1.5;">Works for all countries - USA, UK, Canada, Australia, India, Europe, Middle East. Meets all international format standards.</p>
      </div>
      <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #e5e7eb;">
        <h3 style="font-size: 14px; font-weight: 700; color: #1f2937; margin: 0 0 8px 0;">‚ú® Premium Quality</h3>
        <p style="font-size: 12px; color: #64748b; margin: 0; line-height: 1.5;">No quality loss during conversion. Perfect for official documents. Free, instant, unlimited conversions.</p>
      </div>
    </div>
  </div>
</div>

<!-- Schema Markup for SEO -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "Image Format Converter - JPG PNG PDF",
  "applicationCategory": "MultimediaApplication",
  "operatingSystem": "Any",
  "offers": {
    "@type": "Offer",
    "price": "0"
  },
  "featureList": "Convert JPG PNG WebP GIF BMP PDF, Batch conversion, High quality output, No quality loss, Instant conversion, Free forever, No watermark",
  "countriesSupported": "US, GB, CA, AU, IN, NZ, SG, AE, SA, DE, FR, IT, ES"
}
</script>

<footer class="footer">
  <div class="footer-content">
    <p><strong>GS DocSeva</strong> ‚Äî Free Government Exam Document Preparation Suite</p>
    <div class="footer-links">
      <a href="index.html">Home</a>
      <a href="privacy-policy.html">Privacy Policy</a>
      <a href="terms-of-service.html">Terms of Service</a>
    </div>
    <div class="footer-divider"></div>
    <div class="footer-bottom">
      <p>¬© 2025 GS DocSeva. All rights reserved. | Your documents stay completely private</p>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script src="helpers.js"></script>
<script>
  // Configuration
  const MAX_IMAGE_SIZE = 10 * 1024 * 1024; // 10MB
  // Small UX wiring for mobile-friendly file selection and previews
  (function() {
    // Image
    const imageFile = document.getElementById('imageFile');
    const chooseImgBtn = document.getElementById('chooseImageBtn');
    const uploadArea = document.getElementById('imageUploadArea');
    const preview = document.getElementById('imagePreview');
    const placeholder = document.getElementById('imagePlaceholder');

    if (chooseImgBtn && imageFile) chooseImgBtn.addEventListener('click', () => imageFile.click());
    if (uploadArea && imageFile) uploadArea.addEventListener('click', (e) => { if (!e.target.closest('#chooseImageBtn')) imageFile.click(); });
    if (preview) { preview.addEventListener('load', () => { preview.style.display = 'block'; if (placeholder) placeholder.style.display = 'none'; }); preview.addEventListener('error', () => { preview.style.display = 'none'; if (placeholder) placeholder.style.display = 'block'; }); }
    if (imageFile) imageFile.addEventListener('change', function() { setTimeout(() => { try { this.value = this.value ? this.value : ''; } catch(e){} }, 300); });

    // Signature
    const sigFile = document.getElementById('signatureFile');
    const chooseSigBtn = document.getElementById('chooseSigBtn');
    const sigUploadArea = document.getElementById('signatureUploadArea');
    const sigPreview = document.getElementById('signaturePreview');
    const sigCleanPreview = document.getElementById('signatureCleanPreview');

    if (chooseSigBtn && sigFile) chooseSigBtn.addEventListener('click', () => sigFile.click());
    if (sigUploadArea && sigFile) sigUploadArea.addEventListener('click', (e) => { if (!e.target.closest('#chooseSigBtn')) sigFile.click(); });
    if (sigPreview) { sigPreview.addEventListener('load', () => { sigPreview.style.display = 'block'; }); sigPreview.addEventListener('error', () => { sigPreview.style.display = 'none'; }); }
    if (sigCleanPreview) { sigCleanPreview.addEventListener('load', () => { sigCleanPreview.style.display = 'block'; }); sigCleanPreview.addEventListener('error', () => { sigCleanPreview.style.display = 'none'; }); }
    if (sigFile) sigFile.addEventListener('change', function() { setTimeout(() => { try { this.value = this.value ? this.value : ''; } catch(e){} }, 300); });

    // PDF
    const pdfFile = document.getElementById('pdfFile');
    const choosePdfBtn = document.getElementById('choosePdfBtn');
    const pdfUploadArea = document.getElementById('pdfUploadArea');

    if (choosePdfBtn && pdfFile) choosePdfBtn.addEventListener('click', () => pdfFile.click());
    if (pdfUploadArea && pdfFile) pdfUploadArea.addEventListener('click', (e) => { if (!e.target.closest('#choosePdfBtn')) pdfFile.click(); });
    if (pdfFile) pdfFile.addEventListener('change', function() { setTimeout(() => { try { this.value = this.value ? this.value : ''; } catch(e){} }, 300); });
  })();

  const MAX_PDF_SIZE = 50 * 1024 * 1024; // 50MB
  const SUPPORTED_IMAGE_TYPES = ['image/jpeg', 'image/png', 'image/webp', 'image/gif', 'image/bmp', 'image/tiff', 'image/svg+xml'];

  let uploadedImage = null;
  let signatureImage = null;
  let signatureFileName = '';
  let signatureFileInfo = '';
  let pdfDocument = null;
  let blobUrls = []; // Track blob URLs for cleanup

  // Auto-select format based on URL parameters
  (function autoSelectFormat() {
    try {
      const urlParams = new URLSearchParams(window.location.search);
      const url = window.location.href.toLowerCase();
      const search = window.location.search.toLowerCase();
      const hash = window.location.hash.toLowerCase();
      
      const formatSelect = document.getElementById('imageFormat');
      if (!formatSelect) return;

      // Helper to set format and update meta/title
      function applyFormat(f) {
        formatSelect.value = f;
        try { updateTargetFormat(); } catch (e) {}
        try { updatePageMeta(f); } catch (e) {}
      }

      // Check URL parameters first (to= or format=)
      if (urlParams.has('to') || urlParams.has('format') || urlParams.has('f')) {
        const toFormat = (urlParams.get('to') || urlParams.get('format') || urlParams.get('f')).toLowerCase();
        if (['jpg', 'jpeg', 'png', 'webp', 'gif', 'bmp', 'pdf'].includes(toFormat)) {
          applyFormat(toFormat === 'jpeg' ? 'jpg' : toFormat);
          return;
        }
      }

      // Also accept ?q= or search queries like ?q=convert+to+png
      if (urlParams.has('q')) {
        const q = urlParams.get('q').toLowerCase();
        if (q.includes('png')) { applyFormat('png'); return; }
        if (q.includes('pdf')) { applyFormat('pdf'); return; }
        if (q.includes('webp')) { applyFormat('webp'); return; }
        if (q.includes('gif')) { applyFormat('gif'); return; }
        if (q.includes('bmp')) { applyFormat('bmp'); return; }
        if (q.includes('jpg') || q.includes('jpeg')) { applyFormat('jpg'); return; }
      }

      // Check path, hash, and search for common patterns (legacy support)
      const combinedUrl = url + search + hash;
      const checks = [
        ['png', 'png'], ['pdf', 'pdf'], ['webp', 'webp'], ['gif', 'gif'], ['bmp', 'bmp'], ['jpg', 'jpg'], ['jpeg', 'jpg']
      ];
      for (const [needle, fmt] of checks) {
        if (combinedUrl.includes(needle)) { applyFormat(fmt); break; }
      }
    } catch (err) {
      console.log('Auto-select format error:', err);
    }
  })();

  // Update page meta tags and title to include selected format (helps SEO when crawlers execute JS)
  function updatePageMeta(format) {
    try {
      const fmt = (format || document.getElementById('imageFormat')?.value || 'image').toUpperCase();
      const title = `Convert to ${fmt} ‚Äî Free Image Converter | GS DocSeva`;
      document.title = title;
      const desc = `Convert images to ${fmt} online ‚Äî JPG, PNG, WebP, GIF, BMP, PDF. Fast, private, no upload.`;
      const descMeta = document.querySelector('meta[name="description"]');
      if (descMeta) descMeta.setAttribute('content', desc);
      const ogTitle = document.querySelector('meta[property="og:title"]');
      if (ogTitle) ogTitle.setAttribute('content', title);
      const ogDesc = document.querySelector('meta[property="og:description"]');
      if (ogDesc) ogDesc.setAttribute('content', desc);
      const twTitle = document.querySelector('meta[name="twitter:title"]');
      if (twTitle) twTitle.setAttribute('content', title);
      const twDesc = document.querySelector('meta[name="twitter:description"]');
      if (twDesc) twDesc.setAttribute('content', desc);
      // Update canonical link to include query
      let canon = document.querySelector('link[rel="canonical"]');
      if (!canon) { canon = document.createElement('link'); canon.rel = 'canonical'; document.head.appendChild(canon); }
      const url = new URL(window.location.href);
      url.searchParams.set('to', format);
      canon.href = url.toString();
    } catch (e) { console.warn('updatePageMeta failed', e); }
  }

  // Utility function to show loading
  function showLoading(elementId, message = '‚è≥ Processing...') {
    document.getElementById(elementId).innerHTML = `<div class="result-msg"><span class="spinner"></span>${message}</div>`;
  }

  // Utility function to show success
  function showSuccess(elementId, message) {
    document.getElementById(elementId).innerHTML = `<div class="result-msg">‚úÖ ${message}</div>`;
  }

  // Utility function to show error
  function showError(elementId, message) {
    document.getElementById(elementId).innerHTML = `<div class="result-msg error">‚ùå ${message}</div>`;
  }

  // Utility function to show warning
  function showWarning(elementId, message) {
    document.getElementById(elementId).innerHTML = `<div class="result-msg warning">‚ö†Ô∏è ${message}</div>`;
  }

  // File size validation
  function validateFileSize(file, maxSize) {
    if (file.size > maxSize) {
      const sizeMB = (maxSize / (1024 * 1024)).toFixed(1);
      const fileSizeMB = (file.size / (1024 * 1024)).toFixed(1);
      return { valid: false, error: `File size ${fileSizeMB}MB exceeds limit of ${sizeMB}MB` };
    }
    return { valid: true };
  }

  // File type validation
  function validateFileType(file, validTypes) {
    if (!validTypes.includes(file.type)) {
      return { valid: false, error: 'Invalid file type. Please upload a valid format.' };
    }
    return { valid: true };
  }

  // Format file size for display
  function formatFileSize(bytes) {
    if (bytes === 0) return '0 Bytes';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
  }

  // Cleanup blob URLs
  function cleanupBlobUrls() {
    blobUrls.forEach(url => URL.revokeObjectURL(url));
    blobUrls = [];
  }

  // ============== IMAGE CONVERTER ==============

  // Image File Upload
  document.getElementById('imageFile').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (!file) return;

    const output = document.getElementById('imageOutput');

    // Validate file size
    const sizeValidation = validateFileSize(file, MAX_IMAGE_SIZE);
    if (!sizeValidation.valid) {
      showError('imageOutput', sizeValidation.error);
      return;
    }

    // Validate file type
    const typeValidation = validateFileType(file, SUPPORTED_IMAGE_TYPES);
    if (!typeValidation.valid) {
      showError('imageOutput', typeValidation.error);
      return;
    }

    showLoading('imageOutput', '‚è≥ Loading image...');

    const reader = new FileReader();
    reader.onload = function(event) {
      uploadedImage = new Image();
      uploadedImage.onload = function() {
        const preview = document.getElementById('imagePreview');
        const placeholder = document.getElementById('imagePlaceholder');
        const infoDiv = document.getElementById('imageInfo');
        preview.src = event.target.result;
        preview.style.display = 'block';
        placeholder.style.display = 'none';
        // Show file info below preview
        const formatName = file.type.split('/')[1]?.toUpperCase() || 'IMG';
        infoDiv.innerHTML = `${formatName} ‚Ä¢ ${uploadedImage.width}x${uploadedImage.height}px<br>${formatFileSize(file.size)}`;
        // Show conversion indicator
        const indicator = document.getElementById('conversionIndicator');
        const currentFormat = document.getElementById('currentFormat');
        const targetFormat = document.getElementById('targetFormat');
        currentFormat.textContent = formatName;
        targetFormat.textContent = document.getElementById('imageFormat').value.toUpperCase();
        indicator.style.display = 'block';
        document.getElementById('imageOutput').innerHTML = '';

        // Hide the upload area after a successful upload and add a compact Change Image control
        try {
          const uploadAreaEl = document.getElementById('imageUploadArea');
          if (uploadAreaEl) uploadAreaEl.style.display = 'none';

          // Create a small change control if not present
          if (!document.getElementById('changeUploadContainer')) {
            const container = document.createElement('div');
            container.id = 'changeUploadContainer';
            container.style.cssText = 'margin:10px 0; text-align:center;';
            container.innerHTML = '<button id="changeImageBtn" class="btn" style="width:160px; padding:10px 12px;">üîÅ Change Image</button>';
            // insert before the preview column (uploadAreaEl parent)
            uploadAreaEl.parentNode.insertBefore(container, uploadAreaEl);

            const changeBtn = document.getElementById('changeImageBtn');
            if (changeBtn) {
              changeBtn.addEventListener('click', () => {
                if (uploadAreaEl) uploadAreaEl.style.display = 'block';
                container.style.display = 'none';
                try { document.getElementById('imageFile').click(); } catch (e) { console.warn('open picker failed', e); }
              });
            }
          } else {
            // ensure visible
            document.getElementById('changeUploadContainer').style.display = 'block';
          }
        } catch (e) { console.warn('change control insert failed', e); }
      };
      uploadedImage.onerror = function() {
        showError('imageOutput', '‚ùå Failed to load image. File may be corrupt or unsupported.');
        uploadedImage = null;
      };
      uploadedImage.src = event.target.result;
    };
    reader.onerror = function() {
      showError('imageOutput', 'Error reading file. Please try again.');
    };
    reader.readAsDataURL(file);
  });

  // Drag and drop for image
  const imageUploadArea = document.getElementById('imageFile').parentElement;
  ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
    imageUploadArea.addEventListener(eventName, preventDefaults, false);
  });

  function preventDefaults(e) {
    e.preventDefault();
    e.stopPropagation();
  }

  ['dragenter', 'dragover'].forEach(eventName => {
    imageUploadArea.addEventListener(eventName, () => {
      imageUploadArea.classList.add('dragover');
    });
  });

  ['dragleave', 'drop'].forEach(eventName => {
    imageUploadArea.addEventListener(eventName, () => {
      imageUploadArea.classList.remove('dragover');
    });
  });

  imageUploadArea.addEventListener('drop', (e) => {
    const dt = e.dataTransfer;
    const files = dt.files;
    document.getElementById('imageFile').files = files;
    
    const event = new Event('change', { bubbles: true });
    document.getElementById('imageFile').dispatchEvent(event);
  });

  // Update target format in conversion indicator
  function updateTargetFormat() {
    const targetFormat = document.getElementById('targetFormat');
    if (targetFormat) {
      targetFormat.textContent = document.getElementById('imageFormat').value.toUpperCase();
    }
  }

  // Update meta/title whenever user changes the desired output format
  try {
    const fmtSel = document.getElementById('imageFormat');
    if (fmtSel) {
      fmtSel.addEventListener('change', () => {
        try { updateTargetFormat(); } catch (e) {}
        try { updatePageMeta(fmtSel.value); } catch (e) {}
      });
    }
  } catch (e) {}

  function convertImage() {
    if (!uploadedImage || !uploadedImage.width || !uploadedImage.height) {
      showError('imageOutput', 'Please upload a valid image first');
      return;
    }

    const format = document.getElementById('imageFormat').value;
    showLoading('imageOutput', `‚è≥ Converting to ${format.toUpperCase()}...`);

    try {
      const canvas = document.createElement('canvas');
      canvas.width = uploadedImage.width;
      canvas.height = uploadedImage.height;
      const ctx = canvas.getContext('2d');
      ctx.drawImage(uploadedImage, 0, 0);

      // Handle PDF conversion with jsPDF
      if (format === 'pdf') {
        try {
          showLoading('imageOutput', '‚è≥ Creating PDF...');
          if (typeof window.jspdf === 'undefined') {
            throw new Error('PDF library not loaded');
          }
          const { jsPDF } = window.jspdf;
          const imgWidth = uploadedImage.width;
          const imgHeight = uploadedImage.height;
          let pdfWidth, pdfHeight;
          const maxWidth = 210;
          const maxHeight = 297;
          const ratio = imgWidth / imgHeight;
          if (imgWidth > imgHeight) {
            pdfWidth = Math.min(maxWidth, imgWidth * 0.264583);
            pdfHeight = pdfWidth / ratio;
          } else {
            pdfHeight = Math.min(maxHeight, imgHeight * 0.264583);
            pdfWidth = pdfHeight * ratio;
          }
          const pdf = new jsPDF({
            orientation: imgWidth > imgHeight ? 'landscape' : 'portrait',
            unit: 'mm',
            format: [pdfWidth, pdfHeight]
          });
          const imgData = canvas.toDataURL('image/jpeg', 0.95);
          pdf.addImage(imgData, 'JPEG', 0, 0, pdfWidth, pdfHeight);
          pdf.save('converted-image.pdf');
          showSuccess('imageOutput', `‚úÖ Converted to PDF successfully!`);
        } catch (err) {
          console.error('PDF conversion error:', err);
          showError('imageOutput', '‚ùå PDF conversion failed. Please try again or choose another format.');
        }
        return;
      }

      // GIF format handling with GIF.js library
      if (format === 'gif') {
        try {
          showLoading('imageOutput', '‚è≥ Creating GIF...');
          if (typeof GIF === 'undefined') {
            throw new Error('GIF library not loaded');
          }
          const gif = new GIF({
            workers: 2,
            quality: 10,
            width: canvas.width,
            height: canvas.height
          });
          gif.addFrame(canvas, {delay: 0});
          gif.on('finished', function(blob) {
            lastConvertedBlob = blob;
            lastConvertedFileName = 'converted.gif';
            const url = URL.createObjectURL(blob);
            blobUrls.push(url);
            const a = document.createElement('a');
            a.href = url;
            a.download = appendBrand(lastConvertedFileName || `converted.${extension}`);
            a.click();
            setTimeout(() => {
              URL.revokeObjectURL(url);
              blobUrls = blobUrls.filter(u => u !== url);
            }, 1000);
            showSuccess('imageOutput', `‚úÖ Converted to GIF (${formatFileSize(blob.size)})`);
          });
          gif.on('error', function(err) {
            console.error('GIF creation error:', err);
            showError('imageOutput', '‚ùå GIF conversion failed. Please try another format.');
          });
          gif.render();
        } catch (err) {
          console.error('GIF conversion error:', err);
          showError('imageOutput', '‚ùå GIF conversion failed. Please try another format.');
        }
        return;
      }

      // For JPG, PNG, WebP, BMP: always use toDataURL for max compatibility
      let mimeType = '';
      let extension = format;
      if (format === 'jpg' || format === 'jpeg') {
        mimeType = 'image/jpeg';
        extension = 'jpg';
      } else if (format === 'png') {
        mimeType = 'image/png';
        extension = 'png';
      } else if (format === 'webp') {
        mimeType = 'image/webp';
        extension = 'webp';
      } else if (format === 'bmp') {
        mimeType = 'image/bmp';
        extension = 'bmp';
      } else {
        showError('imageOutput', '‚ùå This format is not supported for conversion.');
        return;
      }

      try {
        let quality = 0.95;
        if (format === 'jpg' || format === 'jpeg') quality = 0.92;
        if (format === 'webp') quality = 0.90;
        const dataUrl = canvas.toDataURL(mimeType, quality);
        // Download
        const a = document.createElement('a');
        a.href = dataUrl;
        a.download = appendBrand(`converted.${extension}`);
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        showSuccess('imageOutput', `‚úÖ Converted to ${format.toUpperCase()}!`);
        // Save for WhatsApp share
        fetch(dataUrl)
          .then(res => res.blob())
          .then(blob => { lastConvertedBlob = blob; lastConvertedFileName = `converted.${extension}`; });
      } catch (err) {
        showError('imageOutput', '‚ùå Conversion failed. Your browser may not support this format.');
      }
    } catch (err) {
      showError('imageOutput', `‚ùå Error: ${err.message}`);
    }
  }

  function resetImage() {
    document.getElementById('imageFile').value = '';
    const preview = document.getElementById('imagePreview');
    const placeholder = document.getElementById('imagePlaceholder');
    const infoDiv = document.getElementById('imageInfo');
    
    preview.style.display = 'none';
    placeholder.style.display = 'block';
    infoDiv.innerHTML = '-';
    document.getElementById('imageOutput').innerHTML = '';
    uploadedImage = null;
    cleanupBlobUrls();
    try {
      const uploadAreaEl = document.getElementById('imageUploadArea');
      if (uploadAreaEl) uploadAreaEl.style.display = 'block';
      const container = document.getElementById('changeUploadContainer');
      if (container && container.parentNode) container.parentNode.removeChild(container);
    } catch (e) { console.warn('reset restore failed', e); }
  }

  // ============== SIGNATURE CLEANER ==============

  // Signature File Upload (only attach handlers if signature elements exist on this page)
  (function() {
    const sigElem = document.getElementById('signatureFile');
    if (!sigElem) return;

    sigElem.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;

      // Validate file size and type
      const sizeValidation = validateFileSize(file, MAX_IMAGE_SIZE);
      if (!sizeValidation.valid) {
        showError('signatureOutput', sizeValidation.error);
        return;
      }

      const typeValidation = validateFileType(file, SUPPORTED_IMAGE_TYPES);
      if (!typeValidation.valid) {
        showError('signatureOutput', typeValidation.error);
        return;
      }

      showLoading('signatureOutput', '‚è≥ Loading signature...');

      const reader = new FileReader();
      reader.onload = function(event) {
        signatureImage = new Image();
        signatureImage.onload = function() {
          const originalPreview = document.getElementById('signaturePreview');
          if (originalPreview) {
            originalPreview.src = event.target.result;
            originalPreview.style.display = 'block';
          }

          signatureFileName = file.name.replace(/\.[^.]+$/, '');
          signatureFileInfo = `<div class="file-info">‚úçÔ∏è ${file.name} (${formatFileSize(file.size)}) ‚Ä¢ ${signatureImage.width}x${signatureImage.height}px</div>`;
          const out = document.getElementById('signatureOutput');
          if (out) out.innerHTML = signatureFileInfo;

          // Auto-clean once loaded for quick preview
          processSignature(false);
        };
        signatureImage.src = event.target.result;
      };
      reader.onerror = function() {
        showError('signatureOutput', 'Error reading file. Please try again.');
      };
      reader.readAsDataURL(file);
    });

    // Drag and drop for signature
    const signatureUploadArea = sigElem.parentElement;
    if (signatureUploadArea) {
      ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        signatureUploadArea.addEventListener(eventName, preventDefaults, false);
      });

      ['dragenter', 'dragover'].forEach(eventName => {
        signatureUploadArea.addEventListener(eventName, () => signatureUploadArea.classList.add('dragover'));
      });

      ['dragleave', 'drop'].forEach(eventName => {
        signatureUploadArea.addEventListener(eventName, () => signatureUploadArea.classList.remove('dragover'));
      });

      signatureUploadArea.addEventListener('drop', (e) => {
        const dt = e.dataTransfer;
        const files = dt.files;
        sigElem.files = files;
        const ev = new Event('change', { bubbles: true });
        sigElem.dispatchEvent(ev);
      });
    }
  })();

  function describeSigLevel(val) {
    const num = Number(val);
    if (num <= 175) return 'Light';
    if (num >= 205) return 'Bold';
    return 'Normal';
  }

  function updateSigLabel(val, labelOverride) {
    const label = labelOverride || describeSigLevel(val);
    document.getElementById('sigLevelLabel').textContent = `${label} (${val})`;
    if (signatureImage) {
      processSignature(false);
    }
  }

  function setSigLevel(val, label) {
    const slider = document.getElementById('sigThreshold');
    slider.value = val;
    updateSigLabel(val, label);
  }

  function processSignature(shouldDownload = true) {
    if (!signatureImage) {
      showError('signatureOutput', 'Please upload a signature first');
      return;
    }

    if (shouldDownload) {
      showLoading('signatureOutput', '‚è≥ Cleaning signature...');
    }

    const threshold = Number(document.getElementById('sigThreshold').value);
    const canvas = document.createElement('canvas');
    canvas.width = signatureImage.width;
    canvas.height = signatureImage.height;
    const ctx = canvas.getContext('2d');
    ctx.drawImage(signatureImage, 0, 0);

    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    const data = imageData.data;
    const softness = 18; // small band for smoother edges

    for (let i = 0; i < data.length; i += 4) {
      const r = data[i];
      const g = data[i + 1];
      const b = data[i + 2];
      const gray = 0.299 * r + 0.587 * g + 0.114 * b;

      let alpha = 0;
      if (gray < threshold - softness) {
        alpha = 1; // keep dark ink
      } else if (gray > threshold + softness) {
        alpha = 0; // white background
      } else {
        alpha = (threshold + softness - gray) / (2 * softness); // soft transition
      }

      const ink = Math.round(255 * (1 - 0.85 * alpha)); // darker for ink areas
      data[i] = data[i + 1] = data[i + 2] = Math.min(255, ink);
      data[i + 3] = 255; // opaque white background
    }

    ctx.putImageData(imageData, 0, 0);

    const cleanPreview = document.getElementById('signatureCleanPreview');
    cleanPreview.src = canvas.toDataURL('image/png');
    cleanPreview.style.display = 'block';

    if (!shouldDownload) {
      const message = '<div class="result-msg">‚úÖ Preview updated ‚Äî adjust ink strength if needed.</div>';
      document.getElementById('signatureOutput').innerHTML = `${signatureFileInfo || ''}${message}`;
      return;
    }

    canvas.toBlob(blob => {
      if (!blob) {
        showError('signatureOutput', 'Error creating cleaned signature.');
        return;
      }

      lastConvertedBlob = blob;
      lastConvertedFileName = `${signatureFileName || 'signature'}-clean.png`;

      const url = URL.createObjectURL(blob);
      blobUrls.push(url);

      const a = document.createElement('a');
      a.href = url;
      a.download = appendBrand(lastConvertedFileName || 'converted');
      a.click();

      setTimeout(() => {
        URL.revokeObjectURL(url);
        blobUrls = blobUrls.filter(u => u !== url);
      }, 1000);

      document.getElementById('signatureOutput').innerHTML = `${signatureFileInfo || ''}<div class="result-msg">‚úÖ Signature cleaned and downloaded as PNG!</div>`;
    }, 'image/png', 0.95);
  }

  function cleanSignature() {
    processSignature(true);
  }

  function resetSignature() {
    const sigElem = document.getElementById('signatureFile');
    if (sigElem) sigElem.value = '';
    const sp = document.getElementById('signaturePreview'); if (sp) sp.style.display = 'none';
    const scp = document.getElementById('signatureCleanPreview'); if (scp) scp.style.display = 'none';
    const sout = document.getElementById('signatureOutput'); if (sout) sout.innerHTML = '';
    signatureImage = null;
    signatureFileName = '';
    signatureFileInfo = '';
    cleanupBlobUrls();
  }

  // ============== PDF CONVERTER ==============

  // PDF File Upload (only attach handlers if pdf elements exist)
  (function() {
    const pdfElem = document.getElementById('pdfFile');
    if (!pdfElem) return;

    pdfElem.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;

      // Validate file size
      const sizeValidation = validateFileSize(file, MAX_PDF_SIZE);
      if (!sizeValidation.valid) {
        showError('pdfOutput', sizeValidation.error);
        return;
      }

      if (file.type !== 'application/pdf') {
        showError('pdfOutput', 'Please upload a valid PDF file');
        return;
      }

      showLoading('pdfOutput', '‚è≥ Loading PDF...');

      const fileUrl = URL.createObjectURL(file);
      blobUrls.push(fileUrl);

      pdfjsLib.getDocument(fileUrl).promise.then(pdf => {
        pdfDocument = pdf;
        const fileInfo = `<div class="file-info">üìÑ ${file.name} (${formatFileSize(file.size)}) ‚Ä¢ ${pdf.numPages} page(s)</div>`;
        const out = document.getElementById('pdfOutput'); if (out) out.innerHTML = fileInfo;
      }).catch(err => {
        showError('pdfOutput', 'Error loading PDF. File may be corrupted.');
        console.error('PDF Error:', err);
      });
    });

    // Drag and drop for PDF
    const pdfUploadArea = pdfElem.parentElement;
    if (pdfUploadArea) {
      ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        pdfUploadArea.addEventListener(eventName, preventDefaults, false);
      });

      ['dragenter', 'dragover'].forEach(eventName => {
        pdfUploadArea.addEventListener(eventName, () => {
          pdfUploadArea.classList.add('dragover');
        });
      });

      ['dragleave', 'drop'].forEach(eventName => {
        pdfUploadArea.addEventListener(eventName, () => {
          pdfUploadArea.classList.remove('dragover');
        });
      });

      pdfUploadArea.addEventListener('drop', (e) => {
        const dt = e.dataTransfer;
        const files = dt.files;
        pdfElem.files = files;
        const event = new Event('change', { bubbles: true });
        pdfElem.dispatchEvent(event);
      });
    }
  })();

  function convertPDF() {
    if (!pdfDocument) {
      showError('pdfOutput', 'Please upload a PDF first');
      return;
    }

    showLoading('pdfOutput', '‚è≥ Converting PDF... This may take a moment...');
    
    const format = document.getElementById('pdfFormat').value;
    convertPDFToImages(pdfDocument, format);
  }

  function convertPDFToImages(pdf, format) {
    const mimeType = format === 'jpg' ? 'image/jpeg' : `image/${format}`;
    let converted = 0;
    const totalPages = pdf.numPages;

    for (let i = 1; i <= totalPages; i++) {
      pdf.getPage(i).then(page => {
        const canvas = document.createElement('canvas');
        const context = canvas.getContext('2d');
        const viewport = page.getViewport({ scale: 2 });

        canvas.height = viewport.height;
        canvas.width = viewport.width;

        return page.render({
          canvasContext: context,
          viewport: viewport
        }).promise.then(() => {
          canvas.toBlob(blob => {
            if (blob) {
              const url = URL.createObjectURL(blob);
              blobUrls.push(url);
              
              const a = document.createElement('a');
              a.href = url;
              a.download = appendBrand(`page-${String(i).padStart(3, '0')}.${format === 'jpg' ? 'jpg' : format}`);
              a.click();
              
              setTimeout(() => {
                URL.revokeObjectURL(url);
                blobUrls = blobUrls.filter(u => u !== url);
              }, 1000);
            }
            
            converted++;
            if (converted === totalPages) {
              showSuccess('pdfOutput', `All ${totalPages} page(s) converted and downloaded!`);
            }
          }, mimeType, 0.92);
        });
      }).catch(err => {
        showError('pdfOutput', `Error processing page ${i}`);
        console.error('Page Error:', err);
      });
    }
  }

  function resetPDF() {
    document.getElementById('pdfFile').value = '';
    document.getElementById('pdfOutput').innerHTML = '';
    pdfDocument = null;
    cleanupBlobUrls();
  }

  // WhatsApp Share Functions
  let lastConvertedBlob = null;
  let lastConvertedFileName = '';

  async function shareImageWhatsApp() {
    if (!lastConvertedBlob) {
      showError('imageOutput', 'Please convert an image first!');
      return;
    }
    await shareToWhatsApp(lastConvertedBlob, lastConvertedFileName || 'converted-image.jpg', 'Check out my converted image from GS DocSeva!');
  }

  async function shareSignatureWhatsApp() {
    if (!lastConvertedBlob) {
      showError('signatureOutput', 'Please clean signature first!');
      return;
    }
    await shareToWhatsApp(lastConvertedBlob, lastConvertedFileName || 'signature-clean.png', 'Check out my cleaned signature from GS DocSeva!');
  }

  async function sharePDFWhatsApp() {
    showError('pdfOutput', 'PDF pages are downloaded separately. Share them from your files!');
  }

  async function shareToWhatsApp(blob, fileName, text) {
    try {
      const file = new File([blob], fileName, { type: blob.type });
      
      if (navigator.canShare && navigator.canShare({ files: [file] })) {
        await navigator.share({
          files: [file],
          title: fileName,
          text: text
        });
        return;
      }
      
      // Fallback
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = appendBrand(fileName);
      a.click();
      
      const message = text + ' - https://resizegovform.netlify.app';
      const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
      window.open(whatsappUrl, '_blank');
    } catch (error) {
      console.error('Share error:', error);
    }
  }

  // Cleanup on page unload
  window.addEventListener('beforeunload', cleanupBlobUrls);
</script>

<script>
  // Navigation toggle
  const navToggle = document.querySelector('.nav-toggle');
  const navLinks = document.querySelector('.nav-links');
  
  if (navToggle) {
    navToggle.addEventListener('click', () => {
      navLinks.classList.toggle('active');
    });

    navLinks.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', () => {
        navLinks.classList.remove('active');
      });
    });
  }
</script>
</body>
</html>