<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Favicon (root icons take priority) -->
  <link rel="icon" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <meta name="msapplication-TileImage" content="/favicon-32.png">
  <!-- Backwards-compatible image reference -->
  <link rel="icon" href="images/gs-logo.png" sizes="any">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- SEO Meta Tags -->
  <title>Free Background Remover | Remove BG Online | AI Photo Background Eraser - GS DocSeva</title>
  <meta name="description" content="★ #1 Free AI Background Remover - Worldwide Tool for USA, UK, Canada, Australia, India. Remove background, add white/transparent background for passport, visa, govt exam forms, job applications. No signup. 100% secure & private. Works offline!">
  <meta name="keywords" content="remove background, bg remover, background eraser, remove bg, photo background remover, passport photo background, AI background remover, free background remover, online bg remove, transparent background, image background removal, remove image background, background remover online free, bg eraser, photo background changer, white background photo, red background photo, blue background photo, passport size photo background, background remove app, remove bg from photo, erase background, cut out background, delete background, background cutter, photo editor background remover, change photo background online, remove background from image, background removal tool, automatic background remover, ID card photo background, visa photo background, government exam photo, exam application photo, profile picture background, product photography background, ecommerce photo background, background ko remove kare, bg hataye, photo ka background change kare, background saaf kare, passport photo banaye, ID card photo, white background, online background remover, free bg remove, no signup background remover, instant background removal, SSC photo background, UPSC photo background, bank exam photo, railway exam photo, background remover India, free bg remover no watermark, remove.bg alternative, best background remover, photo background editor, bg remove tool, background cutter free, passport photo maker, ID photo background, exam form photo, government job photo, photo editor online, background change kaise kare">
  <meta name="author" content="GS DocSeva">
  <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <link rel="canonical" href="https://www.gsforesize.online/remove-bg.html">
  
  <!-- Additional SEO Tags -->
  <meta name="language" content="English, Hindi">
  <meta name="geo.region" content="IN">
  <meta name="geo.placename" content="India">
  <meta name="rating" content="general">
  <meta name="revisit-after" content="1 days">
  <meta name="distribution" content="global">
  <meta name="target" content="all">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no">
  
  <!-- Open Graph Tags for Social Media -->
  <meta property="og:title" content="Free Background Remover | Remove BG Online | AI Photo Background Eraser">
  <meta property="og:description" content="★ #1 Free AI Background Remover - Remove background from images instantly. Perfect for passport photos, ID cards, govt exam forms. 100% secure & private. No signup required!">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://www.gsforesize.online/remove-bg.html">
  <meta property="og:image" content="https://www.gsforesize.online/images/bg-remove-banner.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:site_name" content="GS DocSeva">
  <meta property="og:locale" content="en_US">
  <meta property="og:locale:alternate" content="hi_IN">
  
  <!-- Twitter Card Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Free Background Remover | Remove BG Online | AI Photo Background Eraser">
  <meta name="twitter:description" content="★ #1 Free AI Background Remover - Remove background from images instantly. Perfect for passport photos, ID cards, govt exam forms. 100% secure & private.">
  <meta name="twitter:image" content="https://www.gsforesize.online/images/bg-remove-banner.png">
  <meta name="twitter:site" content="@GSDocSeva">
  <meta name="twitter:creator" content="@GSDocSeva">
  
  <!-- Schema.org Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Background Remover - GS DocSeva",
    "applicationCategory": "UtilitiesApplication",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "description": "Free AI-powered background remover for passport photos, ID cards, profile pictures and product images. Remove background online instantly.",
    "operatingSystem": "Web Browser",
    "url": "https://www.gsforesize.online/remove-bg.html",
    "screenshot": "https://www.gsforesize.online/images/bg-remove-banner.png",
    "featureList": [
      "AI-powered background removal",
      "Support for passport photos and ID cards",
      "Custom background color selection",
      "JPG and PNG export formats",
      "100% private - browser-based processing",
      "No signup required"
    ],
    "publisher": {
      "@type": "Organization",
      "name": "GS DocSeva"
    }
  }
  </script>
  
  <link rel="stylesheet" href="style.min.css">
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-E8MTS8MTDT"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-E8MTS8MTDT');
  </script>
  <style>
                        /* Clean, centered, minimal mobile layout like imageresizer.com */
                        @media (max-width: 600px) {
                          html, body {
                            font-size: 14px !important;
                            padding: 0 !important;
                            margin: 0 !important;
                            overflow-x: hidden !important;
                            background: #f4f6fa !important;
                          }
                          .main-container {
                            max-width: 100vw !important;
                            width: 100vw !important;
                            min-width: 0 !important;
                            margin: 0 auto !important;
                            padding: 0 !important;
                            display: flex !important;
                            flex-direction: column !important;
                            align-items: center !important;
                          }
                          .grid-layout {
                            width: 100vw !important;
                            max-width: 100vw !important;
                            display: flex !important;
                            flex-direction: column !important;
                            align-items: center !important;
                            gap: 0 !important;
                            margin: 0 !important;
                            padding: 0 !important;
                          }
                          .upload-section, .preview-box, .controls-section {
                            background: #fff !important;
                            box-shadow: 0 2px 12px rgba(0,0,0,0.07) !important;
                            border-radius: 12px !important;
                            max-width: 96vw !important;
                            width: 96vw !important;
                            min-width: 0 !important;
                            margin: 12px 0 0 0 !important;
                            padding: 16px 2vw 12px 2vw !important;
                            box-sizing: border-box !important;
                            display: block !important;
                            text-align: center !important;
                          }
                          .preview-section, .upload-section, .controls-section, .preview-box {
                            float: none !important;
                            clear: both !important;
                          }
                          .side-content, .right-content, .nav-links {
                            display: none !important;
                          }
                          #processedContainer, #originalPreview, #processedPreview {
                            max-width: 90vw !important;
                            width: 100% !important;
                            max-height: 180px !important;
                            height: auto !important;
                            margin: 0 auto 8px auto !important;
                            display: block !important;
                            border-radius: 10px !important;
                            min-height: unset !important;
                            padding: 0 !important;
                            background: #f4f6fa !important;
                          }
                          .preview-box .image-container {
                            min-height: 100px !important;
                            max-height: 160px !important;
                            padding: 0 !important;
                            background: #f4f6fa !important;
                          }
                          .btn, .btn-primary, .btn-secondary, #downloadBtn, #whatsappShareBtn {
                            width: 100% !important;
                            min-width: 0 !important;
                            font-size: 14px !important;
                            padding: 12px 0 !important;
                            margin-bottom: 10px !important;
                            box-sizing: border-box !important;
                            border-radius: 8px !important;
                          }
                          .action-buttons {
                            flex-direction: column !important;
                            gap: 10px !important;
                          }
                          .bg-color-options {
                            grid-template-columns: repeat(2, 1fr) !important;
                            gap: 8px !important;
                          }
                          .controls-section {
                            padding: 12px 2vw !important;
                          }
                          h1, h2, h3, h4, h5, h6 {
                            font-size: 1.1em !important;
                            margin: 8px 0 !important;
                            font-weight: 600 !important;
                          }
                          .info-box, .footer, .footer-content {
                            font-size: 13px !important;
                            padding: 8px 2vw !important;
                          }
                          .processing-spinner {
                            padding: 10px !important;
                          }
                          .bg-color-btn {
                            height: 36px !important;
                            min-height: 0 !important;
                          }
                          .custom-color-picker input[type="color"] {
                            height: 36px !important;
                          }
                          .nav-container, header, nav {
                            padding: 6px 0 !important;
                          }
                        }
                    /* Ultra-compact, fully mobile-friendly tool layout */
                    @media (max-width: 600px) {
                      html, body {
                        font-size: 12px !important;
                        padding: 0 !important;
                        margin: 0 !important;
                        overflow-x: hidden !important;
                        background: #f9fafb !important;
                      }
                      .main-container, .grid-layout, .upload-section, .preview-box, .controls-section {
                        max-width: 100vw !important;
                        width: 100vw !important;
                        min-width: 0 !important;
                        margin: 0 auto 6px auto !important;
                        padding: 4px 0.5vw !important;
                        box-sizing: border-box !important;
                        display: block !important;
                      }
                      .grid-layout {
                        grid-template-columns: 1fr !important;
                        gap: 6px !important;
                      }
                      .preview-section, .upload-section, .controls-section, .preview-box {
                        float: none !important;
                        clear: both !important;
                      }
                      .side-content, .right-content, .nav-links {
                        display: none !important;
                      }
                      #processedContainer, #originalPreview, #processedPreview {
                        max-width: 98vw !important;
                        width: 100% !important;
                        max-height: 120px !important;
                        height: auto !important;
                        margin: 0 auto !important;
                        display: block !important;
                        border-radius: 6px !important;
                        min-height: unset !important;
                        padding: 0 !important;
                      }
                      .preview-box .image-container {
                        min-height: 80px !important;
                        max-height: 120px !important;
                        padding: 0 !important;
                      }
                      .btn, .btn-primary, .btn-secondary, #downloadBtn, #whatsappShareBtn {
                        width: 100% !important;
                        min-width: 0 !important;
                        font-size: 12px !important;
                        padding: 8px 0 !important;
                        margin-bottom: 6px !important;
                        box-sizing: border-box !important;
                      }
                      .action-buttons {
                        flex-direction: column !important;
                        gap: 6px !important;
                      }
                      .bg-color-options {
                        grid-template-columns: repeat(2, 1fr) !important;
                        gap: 4px !important;
                      }
                      .controls-section {
                        padding: 6px 1vw !important;
                      }
                      h1, h2, h3, h4, h5, h6 {
                        font-size: 1em !important;
                        margin: 4px 0 !important;
                      }
                      .info-box, .footer, .footer-content {
                        font-size: 11px !important;
                        padding: 4px 1vw !important;
                      }
                      .processing-spinner {
                        padding: 8px !important;
                      }
                      .bg-color-btn {
                        height: 32px !important;
                        min-height: 0 !important;
                      }
                      .custom-color-picker input[type="color"] {
                        height: 32px !important;
                      }
                      .nav-container, header, nav {
                        padding: 4px 0 !important;
                      }
                    }
                @media (max-width: 600px) {
                  html, body {
                    font-size: 13px !important;
                  }
                  .main-container, .grid-layout, .upload-section, .preview-box, .controls-section {
                    max-width: 100vw !important;
                    width: 100vw !important;
                    min-width: 0 !important;
                    margin: 0 auto 8px auto !important;
                    padding: 6px 1vw !important;
                    box-sizing: border-box !important;
                    display: block !important;
                  }
                  .preview-section, .upload-section, .controls-section, .preview-box {
                    float: none !important;
                    clear: both !important;
                  }
                  .side-content, .right-content, .nav-links {
                    display: none !important;
                  }
                  #processedContainer, #originalPreview, #processedPreview {
                    max-width: 92vw !important;
                    width: 100% !important;
                    max-height: 180px !important;
                    height: auto !important;
                    margin: 0 auto !important;
                    display: block !important;
                    border-radius: 8px !important;
                  }
                  .preview-box .image-container {
                    min-height: 120px !important;
                    max-height: 160px !important;
                    padding: 0 !important;
                  }
                  .btn, .btn-primary, .btn-secondary, #downloadBtn, #whatsappShareBtn {
                    width: 100% !important;
                    min-width: 0 !important;
                    font-size: 13px !important;
                    padding: 10px 0 !important;
                    margin-bottom: 8px !important;
                    box-sizing: border-box !important;
                  }
                  .action-buttons {
                    flex-direction: column !important;
                    gap: 8px !important;
                  }
                  .bg-color-options {
                    grid-template-columns: repeat(2, 1fr) !important;
                    gap: 6px !important;
                  }
                  .controls-section {
                    padding: 8px 1vw !important;
                  }
                  h1, h2, h3, h4, h5, h6 {
                    font-size: 1em !important;
                    margin: 6px 0 !important;
                  }
                  .info-box, .footer, .footer-content {
                    font-size: 12px !important;
                    padding: 6px 2vw !important;
                  }
                }
            /* Force all tool sections to be visible and stack vertically on mobile */
            @media (max-width: 900px) {
              .main-container, .grid-layout, .upload-section, .preview-box, .controls-section {
                max-width: 100vw !important;
                width: 100vw !important;
                min-width: 0 !important;
                margin: 0 auto 12px auto !important;
                padding: 10px 2vw !important;
                box-sizing: border-box !important;
                display: block !important;
              }
              .grid-layout {
                grid-template-columns: 1fr !important;
                gap: 10px !important;
              }
              .preview-section, .upload-section, .controls-section, .preview-box {
                float: none !important;
                clear: both !important;
              }
              .side-content, .right-content, .nav-links {
                display: none !important;
              }
              body, html {
                overflow-x: hidden !important;
              }
              #processedContainer, #originalPreview, #processedPreview {
                max-width: 95vw !important;
                width: 100% !important;
                height: auto !important;
                margin: 0 auto !important;
                display: block !important;
              }
              .btn, .btn-primary, .btn-secondary, #downloadBtn, #whatsappShareBtn {
                width: 100% !important;
                min-width: 0 !important;
                font-size: 15px !important;
                padding: 14px 0 !important;
                margin-bottom: 10px !important;
                box-sizing: border-box !important;
              }
              .action-buttons {
                flex-direction: column !important;
                gap: 10px !important;
              }
              .bg-color-options {
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 8px !important;
              }
              .controls-section {
                padding: 12px 2vw !important;
              }
            }
        @media (max-width: 900px) {
          .main-container {
            max-width: 100vw !important;
            width: 100vw !important;
            margin: 0 !important;
            padding: 0 !important;
          }
          .grid-layout {
            grid-template-columns: 1fr !important;
            gap: 10px !important;
            width: 100vw !important;
            margin: 0 !important;
          }
          .preview-section, .upload-section, .controls-section, .preview-box {
            max-width: 100vw !important;
            min-width: 0 !important;
            margin: 0 0 10px 0 !important;
            padding: 10px 2vw !important;
            box-sizing: border-box !important;
          }
          .side-content, .right-content, .nav-links {
            display: none !important;
          }
          body, html {
            overflow-x: hidden !important;
          }
        }
    html, body {
      overflow-x: hidden;
      max-width: 100vw;
    }

    body {
      background: #f9fafb;
      min-height: 100vh;
      margin: 0;
      padding: 0;
    }
    
    header {
      background: white;
      backdrop-filter: blur(20px);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      padding: 20px 0;
      margin-bottom: 20px;
      border-bottom: 1px solid #e2e8f0;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    header .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header h1 {
      font-size: 28px;
      font-weight: 800;
      letter-spacing: -0.5px;
      color: #0c4a6e;
      margin: 0;
      transition: all 0.3s ease;
    }

    header h1:hover {
      transform: scale(1.05);
    }

    header nav {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    header nav a {
      color: #0c4a6e;
      text-decoration: none;
      font-weight: 600;
      font-size: 14px;
      padding: 10px 18px;
      border-radius: 8px;
      transition: all 0.3s ease;
      position: relative;
    }

    header nav a:hover {
      color: #1e293b;
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px);
    }

    header nav a:active {
      transform: translateY(0);
    }

    @media (max-width: 768px) {
      header h1 {
        font-size: 22px;
      }
      
      header nav {
        gap: 4px;
      }
      
      header nav a {
        padding: 8px 12px;
        font-size: 13px;
      }
      
      header .container {
        padding: 0 15px;
      }
    }

    .bg-remove-container {
      max-width: 95%;
      margin: 0 auto;
      padding: 10px;
    }

    .main-container {
      max-width: 1400px;
      width: 100%;
      margin: 0 auto;
      padding: 0 24px;
    }

    .grid-layout {
      display: grid;
      grid-template-columns: 380px minmax(0, 1fr) 440px;
      gap: 20px;
      align-items: start;
      width: 100%;
    }

    @media (max-width: 900px) {
      .grid-layout {
        grid-template-columns: 1fr !important;
        gap: 12px !important;
      }
    }

    @media (max-width: 600px) {
      .main-container {
        max-width: 100vw !important;
        width: 100vw !important;
        padding: 0 !important;
      }
      .grid-layout {
        display: block !important;
        width: 100vw !important;
        padding: 0 !important;
        margin: 0 !important;
      }
      .upload-section, .preview-box, .controls-section {
        max-width: 100vw !important;
        min-width: 0 !important;
        box-sizing: border-box !important;
        margin: 0 0 10px 0 !important;
        padding: 10px 2vw !important;
      }
      .preview-box .image-container {
        min-height: 140px !important;
        max-height: 180px !important;
      }
      #processedContainer, #originalPreview, #processedPreview {
        max-width: 90vw !important;
        max-height: 180px !important;
        width: 100% !important;
        height: auto !important;
      }
      .btn, .btn-primary, .btn-secondary, #downloadBtn, #whatsappShareBtn {
        width: 100% !important;
        min-width: 0 !important;
        font-size: 15px !important;
        padding: 14px 0 !important;
        margin-bottom: 10px !important;
        box-sizing: border-box !important;
      }
      .action-buttons {
        flex-direction: column !important;
        gap: 10px !important;
      }
      .bg-color-options {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 8px !important;
      }
      .controls-section {
        padding: 12px 2vw !important;
      }
      .side-content, .right-content, .nav-links {
        display: none !important;
      }
      body, html {
        overflow-x: hidden !important;
      }
    }

    .upload-section {
      background: white;
      border-radius: 10px;
      padding: 6px;
      text-align: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      margin-bottom: 8px;
      border: 1px solid #e2e8f0;
    }

    .upload-zone {
      border: 1px solid transparent;
      background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
      padding: 26px 18px;
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      transition: all 0.25s ease;
      box-shadow: 0 2px 6px rgba(0,0,0,0.04);
    }

    /* Large full-width primary button for upload area */
    .btn-large {
      display: block;
      width: 100%;
      padding: 16px 20px;
      margin-top: 14px;
      border-radius: 12px;
      border: none;
      background: linear-gradient(135deg, #4f46e5 0%, #4338ca 100%);
      color: #fff;
      font-weight: 700;
      font-size: 16px;
      cursor: pointer;
      box-shadow: 0 8px 24px rgba(67,56,202,0.18);
      transition: transform 0.12s ease, box-shadow 0.12s ease;
    }
    .btn-large:hover { transform: translateY(-2px); box-shadow: 0 12px 28px rgba(67,56,202,0.22); }

    .upload-zone:hover {
      border-color: #667eea;
      background: linear-gradient(135deg, #f8fafc 0%, #e0e7ff 100%);
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .upload-zone.drag-over {
      border-color: #8b5cf6;
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(139, 92, 246, 0.15) 100%);
    }

    /* Keep inputs available for programmatic .click() (Edge requires not display:none) */
    input.hidden-offscreen {
      position: absolute;
      left: -9999px;
      width: 1px;
      height: 1px;
      overflow: hidden;
    }

    .upload-icon {
      font-size: 24px;
      margin-bottom: 4px;
    }

    .preview-section {
      display: block;
      margin-top: 12px;
    }

    .preview-grid {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
      align-items: flex-start;
    }

    .preview-box {
      background: white;
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 3px 15px rgba(0,0,0,0.1);
      flex: 1;
    }

    .preview-placeholder {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      color: #94a3b8;
      font-size: 12px;
      line-height: 1.3;
      pointer-events: none;
      white-space: pre-line;
    }

    /* Force original/processed containers to be square on desktop */
    #originalContainer, #processedContainer {
      width: 220px !important;
      aspect-ratio: 1 / 1 !important;
      min-height: unset !important;
      padding: 10px !important;
      margin: 0 auto !important;
      display: block !important;
    }

    /* Larger cleaned preview box (desktop) should use full column width */
    @media (min-width: 901px) {
      #processedContainer {
        width: 100% !important;
        aspect-ratio: auto !important;
        min-height: 170px !important;
        padding: 10px !important;
      }
    }

    /* Make containers responsive on small screens */
    @media (max-width: 900px) {
      #originalContainer, #processedContainer {
        width: 90vw !important;
        aspect-ratio: 1 / 1 !important;
        max-width: 360px !important;
      }
    }

    .preview-box.main-preview {
      flex: 2;
      min-width: 0;
    }

    .preview-box h3 {
      margin: 0 0 10px 0;
      color: #1e293b;
      font-size: 15px;
      font-weight: 600;
    }

    .preview-box .image-container {
      position: relative;
      width: 100%;
      aspect-ratio: 1 / 1; /* square container */
      max-width: 100%;
      max-height: 400px;
      border-radius: 10px;
      overflow: hidden;
      background:
        repeating-conic-gradient(#e2e8f0 0% 25%, white 0% 50%)
        50% / 20px 20px;
      display: block;
    }

    .preview-box .image-container img,
    .preview-box img {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      max-width: 100%;
      max-height: 100%;
      width: auto;
      height: auto;
      object-fit: contain;
      display: block;
      border-radius: 6px;
    }

    .controls-section {
      background: white;
      border-radius: 12px;
      padding: 20px;
      border: 1px solid #e2e8f0;
    }

    .control-group {
      margin-bottom: 12px;
    }

    .control-group:last-child {
      margin-bottom: 0;
    }

    .control-group label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      color: #475569;
      font-weight: 500;
      font-size: 13px;
    }

    .control-group .value {
      color: #6366f1;
      font-weight: 600;
    }

    .control-group input[type="range"] {
      width: 100%;
      height: 6px;
      border-radius: 4px;
      background: #e2e8f0;
      outline: none;
      -webkit-appearance: none;
      -webkit-appearance: none;
      appearance: none;
    }

    .control-group input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(99, 102, 241, 0.4);
    }

    .control-group input[type="range"]::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      cursor: pointer;
      border: none;
      box-shadow: 0 2px 8px rgba(99, 102, 241, 0.4);
    }

    .bg-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
      border-bottom: 2px solid #f1f5f9;
    }

    .bg-tab {
      padding: 10px 20px;
      background: none;
      border: none;
      color: #64748b;
      font-weight: 600;
      cursor: pointer;
      border-bottom: 3px solid transparent;
      transition: all 0.2s ease;
      font-size: 14px;
    }

    .bg-tab.active {
      color: #3b82f6;
      border-bottom-color: #3b82f6;
    }

    .bg-tab:hover {
      color: #3b82f6;
    }

    .bg-color-options {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 10px;
    }

    .bg-color-btn {
      width: 100%;
      height: 44px;
      border-radius: 6px;
      border: 2px solid transparent;
      cursor: pointer;
      transition: all 0.2s ease;
      position: relative;
      overflow: hidden;
    }

    .bg-color-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .bg-color-btn.active {
      border-color: #3b82f6;
      box-shadow: 0 2px 10px rgba(59, 130, 246, 0.3);
    }

    .bg-color-btn.transparent {
      background: 
        repeating-conic-gradient(#e2e8f0 0% 25%, white 0% 50%) 
        50% / 10px 10px;
      border: 2px solid #e2e8f0;
    }

    .custom-color-picker {
      margin-top: 12px;
      padding: 12px;
      background: #f8fafc;
      border-radius: 6px;
    }

    .custom-color-picker label {
      display: block;
      margin-bottom: 6px;
      color: #475569;
      font-weight: 500;
      font-size: 13px;
    }

    .custom-color-picker input[type="color"] {
      width: 100%;
      height: 50px;
      border: 3px solid #e2e8f0;
      border-radius: 8px;
      cursor: pointer;
    }

    .action-buttons {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
      margin-bottom: 10px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      color: white;
      box-shadow: 0 8px 24px rgba(99, 102, 241, 0.35);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 32px rgba(99, 102, 241, 0.45);
    }

    .btn-secondary {
      background: white;
      color: #6366f1;
      border: 2px solid #6366f1;
    }

    .btn-secondary:hover {
      background: #f8faff;
      transform: translateY(-2px);
    }

    .info-box {
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
      border-left: 3px solid #6366f1;
      padding: 10px 15px;
      border-radius: 6px;
      margin-bottom: 15px;
    }

    .info-box p {
      margin: 0;
      color: #475569;
      font-size: 13px;
    }

    .btn.whatsapp {
      background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
      color: white;
      box-shadow: 0 6px 18px rgba(37,211,102,0.18);
    }
    .btn.reset {
      background: linear-gradient(135deg, #64748b 0%, #475569 100%);
      color: white;
      box-shadow: 0 6px 18px rgba(71,85,105,0.12);
    }

    @media (max-width: 1024px) {
      .preview-grid {
        flex-direction: column !important;
      }
      .preview-box {
        max-width: 100% !important;
      }
      .controls-section {
        max-width: 100% !important;
      }
      .bg-color-options {
        grid-template-columns: repeat(3, 1fr) !important;
      }
      .grid-layout {
        grid-template-columns: 1fr !important;
        gap: 12px !important;
      }
    }

    @media (max-width: 600px) {
      .main-container {
        padding: 0 2vw !important;
      }
      .grid-layout {
        display: block !important;
        padding: 0 !important;
        margin: 0 !important;
      }
      .upload-section, .preview-box, .controls-section {
        max-width: 100vw !important;
        min-width: 0 !important;
        box-sizing: border-box !important;
        margin: 0 0 12px 0 !important;
        padding: 10px 4vw !important;
      }
      .preview-box .image-container {
        min-height: 180px !important;
        max-height: 220px !important;
      }
      #processedContainer, #originalPreview, #processedPreview {
        max-width: 90vw !important;
        max-height: 220px !important;
        width: 100% !important;
        height: auto !important;
      }
      .btn, .btn-primary, .btn-secondary, #downloadBtn, #whatsappShareBtn {
        width: 100% !important;
        min-width: 0 !important;
        font-size: 15px !important;
        padding: 14px 0 !important;
        margin-bottom: 10px !important;
        box-sizing: border-box !important;
      }
      .action-buttons {
        flex-direction: column !important;
        gap: 10px !important;
      }
      .bg-color-options {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 8px !important;
      }
      .controls-section {
        padding: 12px 4vw !important;
      }
    }

    #originalCanvas, #processedCanvas {
      display: none;
    }

    .processing-spinner {
      display: none;
      text-align: center;
      padding: 20px;
    }

    .spinner {
      border: 4px solid #f3f4f6;
      border-top: 4px solid #6366f1;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 15px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Preview improvements: label pills, centered placeholders, arrow */
    .preview-label {
      display: block;
      padding: 6px 14px;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 700;
      text-align: center;
      margin: 0 auto 8px auto;
      position: relative;
      z-index: 3;
    }

    .preview-placeholder {
      font-size: 13px;
      color: #94a3b8;
      text-align: center;
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 80%;
      line-height: 1.25;
      pointer-events: none;
      z-index: 1;
    }

    .preview-arrow {
      text-align: center;
      margin: 10px 0;
      font-size: 20px;
      color: #10b981;
    }

    /* Checkerboard background for transparent preview */
    #processedContainer.checker {
      background-color: transparent;
      background-image:
        linear-gradient(45deg, #e6eef9 25%, transparent 25%),
        linear-gradient(-45deg, #e6eef9 25%, transparent 25%),
        linear-gradient(45deg, transparent 75%, #e6eef9 75%),
        linear-gradient(-45deg, transparent 75%, #e6eef9 75%);
      background-size: 10px 10px;
      background-position: 0 0, 0 5px, 5px -5px, -5px 0;
      border: 1px solid rgba(0,0,0,0.06);
    }

    /* Mobile tweaks to avoid overlap and improve centering */
    @media (max-width: 480px) {
      .preview-label {
        display: block !important;
        margin: 6px auto 8px auto !important;
        padding: 6px 10px !important;
        max-width: 220px !important;
        font-size: 12px !important;
        box-sizing: border-box !important;
        position: relative !important;
        z-index: 3 !important;
      }

      .preview-placeholder {
        font-size: 12px !important;
        width: 90% !important;
      }

      /* On small screens show only the processed preview to simplify UI */
      #originalBlock, #originalLabel, #originalContainer, #originalPreview, #originalPlaceholder, #previewArrow { display: none !important; }
      #processedLabel, #processedContainer, #processedPreview, #processedPlaceholder {
        display: block !important;
        margin: 6px auto 0 auto !important;
        max-width: 220px !important;
        max-height: 220px !important;
        width: 90% !important;
        height: auto !important;
        object-fit: contain !important;
        border-radius: 6px;
      }

      .preview-arrow { display: none !important; }
    }

    /* Ensure preview images stay inside their boxes */
    .preview-img {
      max-width: 100%;
      max-height: 100%;
      width: auto;
      height: auto;
      object-fit: contain;
      display: block;
      position: static !important;
      transform: none !important;
      margin: 0 auto !important;
      z-index: 2;
      max-height: 260px !important;
    }

    /* Center inner preview containers and their image content */
    .preview-box {
      display: flex !important;
      flex-direction: column !important;
      align-items: center !important;
      justify-content: flex-start !important;
      width: 320px !important;
      padding: 16px !important;
      box-sizing: border-box !important;
      margin: 8px auto 20px !important;
      border-radius: 10px !important;
      background: white !important;
      border: 1px solid #e6eef9 !important;
      box-shadow: 0 6px 18px rgba(15,23,42,0.02) !important;
    }
    /* Make preview images use same responsive rules as signature page */
    .preview-img {
      max-width: 100%;
      max-height: 160px;
      object-fit: contain;
      border-radius: 6px;
      position: relative;
      z-index: 2;
    }
    /* Hide any <img> default/broken-icon unless a valid src is present */
    .preview-box img { display: none !important; }
    .preview-box img[src]:not([src=""]) { display: block !important; }
    .preview-box > .image-container,
    .preview-box > div,
    .preview-box > img,
    #originalContainer,
    #processedContainer {
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      margin: 0 auto !important;
      width: 280px !important;
      max-width: 100% !important;
      max-height: 320px !important;
      height: auto !important;
    }
    /* Make inner container visually separate from the preview card */
    #originalContainer, #processedContainer {
      background: #f8fafc !important;
      border: 2px dashed #cbd5e1 !important;
      border-radius: 8px !important;
      padding: 10px !important;
    }
    /* Hide any stray small logos/icons inside preview boxes (only keep our main previews) */
    .preview-box img:not(#originalPreview):not(#processedPreview) { display: none !important; }
    /* Ensure both preview containers use the same sizing rules */
    #originalContainer, #processedContainer { width: 280px !important; max-width: 100% !important; max-height: 320px !important; height: auto !important; }
    /* Ensure label pill is centered and consistent */
    .preview-label { display: block; text-align: center; margin: 0 auto 8px auto; }

    /* Mobile: make previews fluid */
    @media (max-width: 900px) {
      .preview-box { width: 96vw !important; padding: 8px !important; }
      .preview-box > .image-container, #originalContainer, #processedContainer { width: 92vw !important; aspect-ratio: auto !important; max-height: 260px !important; }
      .preview-placeholder { font-size: 12px !important; }
      .preview-box { justify-content: center !important; }
      /* match signature: hide desktop-only cleaned preview and keep single preview */
      .cleaned-preview-desktop { display: none !important; }
      /* upload area padding like signature */
      .upload-area { padding: 12px !important; }
      .controls-section { padding: 8px !important; }
      .btn { width: 100% !important; padding: 10px 12px !important; font-size: 13px !important; }
      /* make hero smaller to save vertical space */
      .hero-visual { display: none !important; }
      /* reduce processed preview size on small screens */
      #processedContainer { max-height: 180px !important; padding: 6px !important; }
      /* hide the whole preview column on mobile until an upload occurs */
      #previewColumn { display: none !important; }
      /* show mobile mini-hero and constrain width/padding for professional spacing */
      .mobile-badge { display: flex !important; gap: 8px; align-items: center; justify-content: flex-start; max-width: 380px; margin: 8px auto; padding: 6px 10px; border-radius: 8px; background: white; box-shadow: 0 2px 8px rgba(0,0,0,0.04); }
      .mobile-badge-logo { height: 28px; width: auto; display: inline-block; border-radius: 6px; }
      .mobile-badge-label { font-size: 14px; font-weight: 800; margin-left: 6px; line-height:1; }
      /* Colorful gradient text for the mobile badge label */
      .mobile-badge-label {
        background: linear-gradient(90deg, #ff7a18 0%, #ffb86b 40%, #7c3aed 70%, #06b6d4 100%);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        text-shadow: 0 1px 0 rgba(0,0,0,0.03);
      }
      .mobile-mini-hero { margin-left: 8px; display:flex; gap:8px; align-items:center; }
      .mobile-mini-hero .mini-thumb img { width:48px; height:60px; }
      /* mini-hero before/after styles */
      .mobile-mini-hero { padding: 6px 8px; display: flex !important; align-items: center; justify-content: center; gap: 8px; }
      .mobile-mini-hero .mini-thumb { display:flex; flex-direction:column; align-items:center; gap:6px; background:white; padding:6px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.04); }
      .mobile-mini-hero .mini-thumb img { width:56px; height:72px; object-fit:cover; border-radius:6px; display:block; }
      .mobile-mini-hero .mini-thumb-label { font-size:11px; color:#475569; font-weight:700; background:linear-gradient(135deg,#fff 0%,#f8fafc 100%); padding:4px 6px; border-radius:6px; }
      .mobile-mini-hero .mini-arrow { font-size:18px; color:#f59e0b; font-weight:800; }
      .main-container { padding-left: 14px !important; padding-right: 14px !important; }
      .grid-layout > div { max-width: 380px; margin: 0 auto; }
      .upload-zone, .upload-area { max-width: 360px !important; margin: 0 auto !important; }
      .upload-area { padding: 8px !important; }
      .controls-section { padding: 6px !important; }
      .btn { width: 100% !important; padding: 8px 10px !important; font-size: 13px !important; }
      /* make upload box visually smaller */
      .upload-zone .btn-choose, .upload-area .btn-choose { padding: 8px 12px !important; font-size: 13px !important; }
      /* compact color options into 4 columns to show more on one row */
      .bg-color-options { grid-template-columns: repeat(4, 1fr) !important; gap: 6px !important; }
      .bg-color-btn { height: 34px !important; padding: 0 !important; }
      .bg-color-btn span, .bg-color-btn::after { display:none; }
    }

    /* ensure badge visible only on mobile up to 900px */
    @media (min-width: 901px) {
      .mobile-badge { display: none !important; }
    }

    @media (max-width: 600px) {
      .preview-box { padding: 6px !important; }
      .preview-box img[src]:not([src=""]) { max-height: 140px !important; }
      .upload-area { padding: 10px !important; }
      .controls-section { padding: 6px !important; }
      .btn { width: 100% !important; padding: 9px 10px !important; font-size: 13px !important; }
      /* make upload box visually smaller */
      .upload-zone .btn-choose, .upload-area .btn-choose { padding: 8px 12px !important; font-size: 13px !important; }
      /* compact color options into 4 columns to show more on one row */
      .bg-color-options { grid-template-columns: repeat(4, 1fr) !important; gap: 6px !important; }
      .bg-color-btn { height: 36px !important; }
      .btn { padding: 9px 10px !important; font-size: 12px !important; }
    }

    /* Make processed/original containers behave like signature preview-box */
    #processedContainer, #originalContainer {
      background: #f8fafc;
      border-radius: 8px;
      padding: 6px;
      min-height: 0;
      display: inline-flex !important;
      align-items: center;
      justify-content: center;
      border: 2px dashed #cbd5e1;
      position: relative;
      margin-bottom: 8px;
      box-sizing: border-box;
      width: auto;
      max-width: 100%;
    }

    /* Processed image sizing: allow natural width/height while limiting to viewport */
    #processedPreview, #originalPreview {
      max-width: 100%;
      height: auto;
      max-height: 80vh;
      display: block;
      object-fit: contain;
      border-radius: 6px;
      z-index: 2;
    }

    /* Constrain preview containers so images can't overflow */
    #processedContainer, #originalPreview, #processedPreview {
      max-width: 160px;
      max-height: 160px;
      overflow: hidden;
      box-sizing: border-box;
    }
  </style>
  <style>
    /* Extra compact overrides for mobile to make color box fit */
    @media (max-width: 900px) {
      .controls-section { max-width: 320px !important; padding: 6px 8px !important; margin: 6px auto !important; }
      .bg-color-options { grid-template-columns: repeat(auto-fit, minmax(34px, 1fr)) !important; gap: 6px !important; }
      .bg-color-btn { height: 30px !important; border-radius: 6px !important; padding: 0 !important; }
      .custom-color-picker input[type="color"] { height: 32px !important; }
      .preview-box { padding: 6px !important; }
      .preview-box img { max-height: 120px !important; }
      .preview-placeholder { font-size: 11px !important; }
      .controls { gap: 8px !important; }
      .format-btn { padding: 6px 8px !important; font-size: 12px !important; }
    }
    @media (max-width: 420px) {
      .controls-section { max-width: 300px !important; padding: 6px 6px !important; }
      .bg-color-options { grid-template-columns: repeat(3, 1fr) !important; gap: 5px !important; }
      .bg-color-btn { height: 28px !important; }
      .mobile-mini-hero .mini-thumb img { width:48px !important; height:60px !important; }
    }
  </style>
  <style>
    /* Ensure controls (color/download) box has horizontal breathing room on all viewports */
    .controls-section {
      box-sizing: border-box;
      margin-left: 12px;
      margin-right: 12px;
      padding-left: 12px;
      padding-right: 12px;
    }
    /* Slightly larger side margins on very wide screens */
    @media (min-width: 1200px) {
      .controls-section { margin-left: 20px; margin-right: 20px; padding-left: 16px; padding-right: 16px; }
    }
    /* On mobile the controls-section should be centered and not touch edges */
    @media (max-width: 900px) {
      .controls-section { margin-left: auto !important; margin-right: auto !important; max-width: 360px; }
    }
    /* Make color grid responsive to container to avoid horizontal overflow */
    .bg-color-options {
      box-sizing: border-box;
      width: 100%;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(44px, 1fr));
      gap: 8px;
    }
    .bg-color-btn {
      min-width: 0;
      width: 100%;
      box-sizing: border-box;
    }
  </style>
  <style>
  /* Desktop overrides: restore original Remove BG desktop spacing and sizes */
  @media (min-width: 1024px) {
    .grid-layout {
      max-width: 1400px;
      width: 100%;
      margin: 14px auto;
      grid-template-columns: 380px minmax(0, 1fr) 440px;
      gap: 20px;
    }

    .upload-zone {
      padding: 20px 16px;
      border: 2px dashed #cbd5e1;
      box-shadow: 0 3px 8px rgba(0,0,0,0.05);
      background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
      min-height: 150px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .btn-large {
      display: block;
      width: 100%;
      padding: 12px 18px;
      margin-top: 10px;
      border-radius: 10px;
      font-size: 15px;
      box-shadow: 0 6px 18px rgba(67,56,202,0.14);
    }

    .preview-box {
      min-height: 140px;
      padding: 8px;
      border: 2px dashed #cbd5e1;
      background: #f8fafc;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .preview-label { padding: 6px 10px; }
    /* Reduce right controls (color/download) box width and keep it aligned */
    .controls-section { max-width: 300px; margin-left: auto; padding-left: 12px; padding-right: 12px; }
    /* Tighter color button layout inside controls to shrink visual size */
    .controls-section .bg-color-options { grid-template-columns: repeat(3, 1fr); gap: 6px; }
    .controls-section .bg-color-btn { height: 30px; border-radius: 6px; }
    .controls-section .format-btn { padding: 6px 10px; font-size: 12px; }
  }
  /* Signature-like responsive behavior */
  @media (max-width: 900px) {
    .grid-layout { grid-template-columns: 1fr !important; gap: 12px; }
    .preview-box { min-height: 120px; padding: 8px; }
    .upload-zone, .upload-area { padding: 16px !important; }
    .cleaned-preview-desktop { display: none !important; }
    .hero-visual { display: none !important; }
  }

  /* Choose button styling similar to signature page */
  .btn-choose {
    background: linear-gradient(135deg, #4f46e5 0%, #4338ca 100%);
    color: white;
    padding: 12px 18px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 700;
    font-size: 14px;
    box-shadow: 0 4px 12px rgba(67,56,202,0.18);
    transition: all 0.2s ease;
  }
  .btn-choose:hover { transform: translateY(-2px); }
  /* Hero visual: compact and only show on larger desktops so the tool fits in one view */
  .hero-visual { max-width: 1100px; margin: 8px auto; font-size: 14px; }
  .hero-visual img { width: 44px; height: 56px; }
  .hero-visual .hero-text { font-size: 12px; }
  @media (max-width: 1100px) {
    .hero-visual { display: none !important; }
  }
  </style>
  <style>
    /* Small overrides to match global theme and prevent local style conflicts */
    .nav-container { height: 96px; }
    .nav-logo { height: 110px; max-width: 520px; }
    .upload-zone, .upload-area { border-radius: 12px; box-shadow: 0 6px 16px rgba(15,23,42,0.04); }
    .preview-box { border-radius: 10px; padding: 10px; }
    .cta-buttons { gap: 14px; margin-bottom: 34px; }
    .animated-gradient { opacity: 0.02 !important; }
    @media (max-width: 900px) {
      .nav-container { height: 72px; }
      .nav-logo { height: 72px; }
      .upload-zone { padding: 12px !important; }
    }
  </style>
</head>
<body>

<!-- Maintenance notice removed -->

<!-- Navigation Bar -->
<nav>
  <div class="nav-container">
      <a href="index.html" class="nav-brand">
      <img src="images/gs-logo-horizontal.png" alt="GS DocSeva Logo" class="nav-logo">
    </a>
    <button class="nav-toggle">
      <span></span>
      <span></span>
      <span></span>
    </button>
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="exam-prep.html">Exam Prep</a></li>
      <li><a href="resize.html">Resize</a></li>
      <li><a href="remove-bg.html" class="active">Remove BG</a></li>
      <li><a href="convert.html">Convert</a></li>
      <li><a href="privacy-policy.html">Privacy</a></li>
    </ul>
  </div>
</nav>

  <div class="main-container">
    <!-- Mobile badge: small logo + label, visible only on mobile -->
    <div class="mobile-badge" aria-hidden="false" style="display:none;">
      <div style="display:flex; align-items:center; gap:8px;">
        <img class="mobile-badge-logo" src="images/logo.png" alt="Logo" onerror="this.style.display='none'">
        <div class="mobile-badge-label">Remove your pic background</div>
      </div>
      <!-- keep the mini before/after thumbs below the label for quick visual workflow -->
      <div class="mobile-mini-hero" style="margin-left:8px;">
        <div class="mini-thumb">
          <img src="images/person-bg.png" alt="With background" />
          <div class="mini-thumb-label">With background</div>
        </div>
        <div class="mini-arrow">→</div>
        <div class="mini-thumb">
          <img src="images/person-nobg.png" alt="No background" />
          <div class="mini-thumb-label">No background</div>
        </div>
      </div>
    </div>
    <!-- Prominent hero visual moved above the tool so visitors immediately see the workflow -->
    <div class="hero-visual">
      <div style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 10px 16px; border-radius: 10px; margin-bottom: 12px; border-left: 4px solid #f59e0b; color: #78350f;">
        <div style="display: flex; align-items: center; justify-content: center; gap: 15px; flex-wrap: wrap;">
          <div style="display: flex; align-items: center; gap: 10px;">
            <div style="background: white; padding: 4px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.12); border: 2px solid #fed7aa;">
              <img src="images/person-bg.png" alt="With Background" style="width: 50px; height: 65px; object-fit: cover; border-radius: 5px; display: block;">
              <div style="font-size: 8px; color: #78350f; font-weight: 700; text-align: center; margin-top: 2px; background: rgba(254, 243, 199, 0.9); padding: 1px 3px; border-radius: 3px;">📷 With BG</div>
            </div>
            <div style="font-size: 20px; color: #f59e0b; font-weight: bold;">→</div>
            <div style="background: white; padding: 4px; border-radius: 8px; box-shadow: 0 2px 8px rgba(34, 197, 94, 0.2); border: 2px solid #86efac;">
              <div style="width: 50px; height: 65px; background: repeating-conic-gradient(#e2e8f0 0% 25%, white 0% 50%) 50% / 10px 10px; border-radius: 5px; display: flex; align-items: center; justify-content: center; position: relative;">
                <img src="images/person-nobg.png" alt="Without Background" style="width: 100%; height: 100%; object-fit: contain; border-radius: 5px; position: relative; z-index: 2;">
              </div>
              <div style="font-size: 8px; color: #15803d; font-weight: 700; text-align: center; margin-top: 2px; background: rgba(209, 250, 229, 0.9); padding: 1px 3px; border-radius: 3px;">🎨 No BG</div>
            </div>
          </div>
          <div style="text-align: center;">
            <div style="font-size: 13px; font-weight: 700; margin-bottom: 2px;">🎨 AI Background Remover</div>
            <div style="font-size: 11px; font-weight: 500;">Upload photo → AI removes background → Choose color → Download</div>
          </div>
        </div>
      </div>
    </div>
    <div id="changeUploadContainer" style="display:none; text-align:center; margin-top:8px;">
      <button id="changeImageBtn" class="btn reset" style="width:160px; font-size:13px;">Change Image</button>
    </div>
    <div class="grid-layout" style="margin-top: 0; display: grid; grid-template-columns: 380px minmax(0,1fr) 440px; gap: 20px; align-items: start; width:100%;">
      <!-- Column 0: Preview (Left) -->
      <div id="previewColumn">
        <div style="background: white; padding: 15px; border-radius: 12px; border: 1px solid #e2e8f0;">
          <h3 style="font-size: 13px; margin: 0 0 15px 0; font-weight: 600; color: #1f2937; text-align: center;">📷 Preview</h3>
          
          <!-- Original removed: single unified preview box retained below -->
          
          <!-- Processed -->
          <div>
            <div class="preview-label" style="background: linear-gradient(135deg, #d1fae5 0%, #bbf7d0 100%); border: 1.5px solid #86efac; margin-bottom: 10px;">
              <span style="color: #15803d;">✨ BG Removed</span>
            </div>
            <div id="processedContainer" class="checker" style="border-radius: 8px; padding: 10px; min-height: 170px; display: flex; align-items: center; justify-content: center; position: relative;">
              <img id="processedPreview" class="preview-img" alt="Processed" onerror="this.style.display='none'; if(document.getElementById('processedPlaceholder')) document.getElementById('processedPlaceholder').style.display='block';" style="display: none; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.04);">
              <span id="processedPlaceholder" class="preview-placeholder" style="color:#16a34a;">Processed image<br>will appear here</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Column 1: Upload (Middle) -->
      <div>
        <div class="upload-zone upload-area upload-lower" id="uploadZone">
          <input type="file" id="imageInput" accept="image/*" class="hidden-offscreen">
          <button id="chooseFileBtn" class="btn-large btn-choose">Choose file</button>
          <div style="font-size: 52px; margin-bottom: 12px;">
            <svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: inline-block;">
              <rect x="8" y="16" width="48" height="40" rx="4" fill="#e0e7ff" stroke="#667eea" stroke-width="2"/>
              <path d="M20 36L28 28L36 36L44 28L52 36" stroke="#667eea" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
              <circle cx="22" cy="26" r="3" fill="#fbbf24"/>
              <path d="M32 8L32 24M32 8L28 12M32 8L36 12" stroke="#10b981" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
              <circle cx="32" cy="24" r="2" fill="#10b981"/>
            </svg>
          </div>
          <p style="margin: 0 0 6px 0; font-size: 16px; font-weight: 700; color: #1f2937;">Upload Your Photo</p>
          <small style="font-size: 11px; color: #64748b; display: block;">Click or drag & drop • JPG, PNG</small>
        </div>
        
        <div style="margin: 12px 0; padding: 10px; background: #eff6ff; border-radius: 6px; border-left: 3px solid #3b82f6; font-size: 11px; color: #64748b;">
          <strong style="color: #1e40af;">🔒 Private & Secure:</strong> All processing happens in your browser. Files never uploaded.
        </div>
        
        <div class="processing-spinner" id="processingSpinner" style="text-align: center; padding: 20px;">
          <div class="spinner"></div>
          <p style="color: #64748b;">Processing image...</p>
        </div>
        
        <!-- Upload-area controls (moved here from right column): format, target KB and action buttons -->
        <div id="uploadControls" style="margin-top:12px; text-align:center;">
          <div style="display:flex; gap:8px; justify-content:center; margin-bottom:8px;">
            <button class="format-btn chip" data-format="jpg" style="padding: 8px 12px; font-size: 12px; font-weight: 700; border-radius: 999px; border: 2px solid #3b82f6; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; cursor: pointer; transition: all 0.2s;">JPG</button>
            <button class="format-btn chip" data-format="png" style="padding: 8px 12px; font-size: 12px; font-weight: 700; border-radius: 999px; border: 2px solid #cbd5e1; background: white; color: #64748b; cursor: pointer; transition: all 0.2s;">PNG</button>
          </div>

          <div style="display:flex; gap:8px; align-items:center; justify-content:center; margin-bottom:10px;">
            <label style="font-size:13px; color:#475569; font-weight:600; margin-right:6px; display:flex; align-items:center; gap:6px;">
              <input id="targetKbToggle" type="checkbox" style="width:16px; height:16px;" />
              Use target KB
            </label>
            <input id="targetKbInput" type="number" min="1" value="100" style="width:110px; padding:8px; border-radius:6px; border:1px solid #e2e8f0; display:none;" />
          </div>

          <div class="controls" style="margin-top:6px; display:flex; gap:8px; justify-content:center;">
            <button id="downloadBtn" class="btn btn-primary">💾 Download</button>
            <button id="whatsappShareBtn" class="btn whatsapp">💬 WhatsApp</button>
            <button id="resetBtn" class="btn reset" onclick="resetRemoveBg()">🔄 Reset</button>
          </div>
        </div>
      </div>

      <!-- Column 2: Settings (Right) -->
      <div>
        <div class="controls-section">
          <h3 style="margin: 0 0 15px 0; font-size: 14px; font-weight: 600; color: #1f2937;">🎨 Background Color</h3>
          
          <div class="bg-color-options" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 15px;">
            <div class="bg-color-btn transparent active" data-color="transparent" title="Transparent" style="width: 100%; height: 45px; border-radius: 8px; cursor: pointer; border: 2px solid #3b82f6; background: repeating-conic-gradient(#e2e8f0 0% 25%, white 0% 50%) 50% / 10px 10px; display: flex; align-items: center; justify-content: center; transition: all 0.2s;">
              <span style="font-size: 18px;">⊘</span>
            </div>
            <div class="bg-color-btn" style="background: white; width: 100%; height: 45px; border-radius: 8px; cursor: pointer; border: 2px solid #e2e8f0; transition: all 0.2s;" data-color="white"></div>
            <div class="bg-color-btn" style="background: #ef4444; width: 100%; height: 45px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;" data-color="#ef4444"></div>
            <div class="bg-color-btn" style="background: #ec4899; width: 100%; height: 45px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;" data-color="#ec4899"></div>
            <div class="bg-color-btn" style="background: #a855f7; width: 100%; height: 45px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;" data-color="#a855f7"></div>
            <div class="bg-color-btn" style="background: #6366f1; width: 100%; height: 45px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;" data-color="#6366f1"></div>
            <div class="bg-color-btn" style="background: #3b82f6; width: 100%; height: 45px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;" data-color="#3b82f6"></div>
            <div class="bg-color-btn" style="background: #0ea5e9; width: 100%; height: 45px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;" data-color="#0ea5e9"></div>
            <div class="bg-color-btn" style="background: #06b6d4; width: 100%; height: 45px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;" data-color="#06b6d4"></div>
            <div class="bg-color-btn" style="background: #14b8a6; width: 100%; height: 45px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;" data-color="#14b8a6"></div>
            <div class="bg-color-btn" style="background: #10b981; width: 100%; height: 45px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;" data-color="#10b981"></div>
            <div class="bg-color-btn" style="background: #84cc16; width: 100%; height: 45px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;" data-color="#84cc16"></div>
            <div class="bg-color-btn" style="background: #f59e0b; width: 100%; height: 45px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;" data-color="#f59e0b"></div>
            <div class="bg-color-btn" style="background: #f97316; width: 100%; height: 45px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;" data-color="#f97316"></div>
            <div class="bg-color-btn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); width: 100%; height: 45px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;" data-color="gradient1"></div>
          </div>
          
          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 8px; font-size: 12px; font-weight: 600; color: #475569;">🎨 Custom Color:</label>
            <input type="color" id="customColorPicker" value="#ffffff" style="width: 100%; height: 45px; border-radius: 8px; border: 2px solid #e2e8f0; cursor: pointer;">
          </div>
          
          <div style="border-top: 1px solid #e2e8f0; padding-top: 15px; margin-top: 15px;">
            <p style="font-size:13px;color:#64748b;text-align:center;margin:0;">Controls moved to the upload area above.</p>
          </div>
        </div>
      </div>
  </div>

  <canvas id="originalCanvas"></canvas>
  <canvas id="processedCanvas"></canvas>

  <!-- SEO Content Section -->
  <div style="max-width: 1200px; margin: 40px auto; padding: 20px; background: #f8fafc; border-radius: 12px;">
    <h1 style="font-size: 24px; font-weight: 700; color: #1f2937; margin-bottom: 16px; text-align: center;">Free AI Background Remover - Remove BG from Photos Online</h1>
    <!-- hero visual moved above main tool -->
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 20px;">
      <div style="background: white; padding: 16px; border-radius: 8px; border-left: 4px solid #3b82f6;">
        <h2 style="font-size: 16px; font-weight: 600; color: #1f2937; margin-bottom: 8px;">For All Your Photo Needs</h2>
        <p style="font-size: 13px; color: #64748b; line-height: 1.6;">Perfect for passport photos, profile pictures, ID cards, resume photos, social media, product images, ecommerce, certificates, and all professional documents. Works for everyone!</p>
      </div>
      
      <div style="background: white; padding: 16px; border-radius: 8px; border-left: 4px solid #10b981;">
        <h2 style="font-size: 16px; font-weight: 600; color: #1f2937; margin-bottom: 8px;">AI-Powered Technology</h2>
        <p style="font-size: 13px; color: #64748b; line-height: 1.6;">Advanced AI automatically detects & removes photo backgrounds in seconds. Works perfectly for any image - personal or professional use. No technical skills needed.</p>
      </div>
      
      <div style="background: white; padding: 16px; border-radius: 8px; border-left: 4px solid #f59e0b;">
        <h2 style="font-size: 16px; font-weight: 600; color: #1f2937; margin-bottom: 8px;">100% Private & Secure</h2>
        <p style="font-size: 13px; color: #64748b; line-height: 1.6;">All background removal processing happens in your browser. No signup required, no file upload to servers. Your photos stay completely private and secure.</p>
      </div>
    </div>
    
    <div style="margin-top: 24px; padding: 16px; background: white; border-radius: 8px;">
      <h2 style="font-size: 18px; font-weight: 600; color: #1f2937; margin-bottom: 12px;">How to Remove Background from Photo</h2>
      <ol style="font-size: 13px; color: #64748b; line-height: 1.8; padding-left: 20px;">
        <li><strong>Upload Photo:</strong> Click upload or drag & drop your image - any photo works</li>
        <li><strong>AI Processing:</strong> Our AI automatically removes the background from your photo instantly</li>
        <li><strong>Choose Color:</strong> Select white, red, blue, or custom color background, or keep it transparent</li>
        <li><strong>Download:</strong> Save in JPG or PNG format - ready to use anywhere</li>
      </ol>
    </div>
    
    <div style="margin-top: 16px; padding: 16px; background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border-radius: 8px; border: 2px solid #93c5fd;">
      <h3 style="font-size: 16px; font-weight: 600; color: #1e40af; margin-bottom: 8px;">Popular Uses</h3>
      <p style="font-size: 13px; color: #1e40af; line-height: 1.6;">Job applications, government exam forms (SSC, UPSC, Railway, Bank, PSC), business documents, resumes, LinkedIn profiles, WhatsApp DP, Instagram posts, product photography, online selling, certificates, and more. Universal background remover for all purposes.</p>
    </div>
  </div>

  <!-- SEO Content Section -->
  <div style="background: #f9fafb; padding: 40px 20px; margin-top: 50px; border-top: 1px solid #e5e7eb;">
    <div style="max-width: 1200px; margin: 0 auto;">
      <div style="display: none;"><!-- SEO Keywords for International Search -->
        remove background from image online, background remover free, erase bg tool, transparent background maker, 
        photo background removal, white background photo, passport photo background, visa photo white bg, 
        AI background remover, automatic bg removal, cut out background online, background eraser tool, 
        remove bg for government forms, exam form photo background, job application white background, 
        USA background removal, UK photo white bg, Canada visa background, Australia photo requirements, India background remover, 
        international background tool, worldwide bg remover, global photo editor, background for any country, 
        बैकग्राउंड हटाएं ऑनलाइन, फोटो की पृष्ठभूमि हटाएं, सफेद बैकग्राउंड फोटो, पासपोर्ट फोटो बैकग्राउंड, 
        सरकारी फॉर्म फोटो तैयार करें, नौकरी आवेदन फोटो बैकग्राउंड, पारदर्शी पृष्ठभूमि बनाएं
      </div>
      
      <h2 style="font-size: 20px; font-weight: 700; color: #1f2937; text-align: center; margin-bottom: 20px;">Professional Background Remover - Worldwide</h2>
      <p style="font-size: 13px; color: #64748b; text-align: center; max-width: 800px; margin: 0 auto 30px; line-height: 1.6;">
        Remove backgrounds and add white/transparent backgrounds for photos. Trusted globally in USA, UK, Canada, Australia, India for passport, visa, government exam, and job application photos.
      </p>
      
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
        <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #e5e7eb;">
          <h3 style="font-size: 14px; font-weight: 700; color: #1f2937; margin: 0 0 8px 0;">🎨 Perfect Backgrounds</h3>
          <p style="font-size: 12px; color: #64748b; margin: 0; line-height: 1.5;">White, transparent, or any color background. Perfect for passports, visas, government forms, and job applications worldwide.</p>
        </div>
        <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #e5e7eb;">
          <h3 style="font-size: 14px; font-weight: 700; color: #1f2937; margin: 0 0 8px 0;">🌐 Global Standards</h3>
          <p style="font-size: 12px; color: #64748b; margin: 0; line-height: 1.5;">Meets photo background requirements for all countries - USA, UK, Canada, Australia, India, Europe, Middle East, Asia-Pacific.</p>
        </div>
        <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #e5e7eb;">
          <h3 style="font-size: 14px; font-weight: 700; color: #1f2937; margin: 0 0 8px 0;">🚀 Fast & Free</h3>
          <p style="font-size: 12px; color: #64748b; margin: 0; line-height: 1.5;">Instant background removal. No registration, no payment. Unlimited use. All processing stays in your browser.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Schema Markup for SEO -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Background Remover - White & Transparent",
    "applicationCategory": "MultimediaApplication",
    "operatingSystem": "Any",
    "offers": {
      "@type": "Offer",
      "price": "0"
    },
    "featureList": "Remove background, White background, Transparent background, Passport photo background, Visa photo, Government form photo, Job application photo, Free forever, Instant processing",
    "countriesSupported": "US, GB, CA, AU, IN, NZ, SG, AE, SA, DE, FR, IT, ES"
  }
  </script>

  <footer class="footer" style="margin-top: 60px;">
    <div class="footer-content">
      <p><strong>GS DocSeva</strong> — Free Government Exam Documen
        
        
        
        
    t Preparation Suite</p>
      <div class="footer-links">
        <a href="index.html">Home</a>
        <a href="privacy-policy.html">Privacy Policy</a>
        <a href="terms-of-service.html">Terms of Service</a>
      </div>
      <div class="footer-divider"></div>
      <div class="footer-bottom">
        <p>© 2025 GS DocSeva. All rights reserved. | Your documents stay completely private</p>
      </div>
    </div>
  </footer>
  <script src="helpers.js"></script>
  <script>
  function resetRemoveBg(){
    // Basic reset behavior: clear inputs and previews
    const imageInput = document.getElementById('imageInput');
    if(imageInput) imageInput.value = '';
    const originalPreview = document.getElementById('originalPreview');
    const processedPreview = document.getElementById('processedPreview');
    const originalPlaceholder = document.getElementById('originalPlaceholder');
    const processedPlaceholder = document.getElementById('processedPlaceholder');
    if(originalPreview) originalPreview.style.display = 'none';
    if(processedPreview) processedPreview.style.display = 'none';
    if(originalPlaceholder) originalPlaceholder.style.display = 'block';
    if(processedPlaceholder) processedPlaceholder.style.display = 'block';
    // Restore upload zone on mobile and remove compact change control
    try {
      const uploadZone = document.getElementById('uploadZone');
      if (uploadZone) uploadZone.style.display = 'block';
        const uploadControlsEl = document.getElementById('uploadControls');
        if (uploadControlsEl) uploadControlsEl.style.display = 'block';
        try { const tToggle = document.getElementById('targetKbToggle'); const tInput = document.getElementById('targetKbInput'); if (tToggle) tToggle.checked = false; if (tInput) { tInput.style.display = 'none'; tInput.value = '100'; } } catch (e) {}
      const changeContainer = document.getElementById('changeUploadContainer');
      if (changeContainer && changeContainer.parentNode) changeContainer.parentNode.removeChild(changeContainer);
      // hide preview column again on mobile after reset
      try { const previewCol = document.getElementById('previewColumn'); if (previewCol && window.matchMedia('(max-width: 900px)').matches) previewCol.style.setProperty('display','none','important'); } catch (e) {}
      if (chooseFileBtn) chooseFileBtn.textContent = 'Choose file';
      if (downloadBtnEl) downloadBtnEl.disabled = true;
      if (whatsappShareBtnEl) whatsappShareBtnEl.disabled = true;
    } catch (e) { console.warn('reset restore failed', e); }
    // reset color selection to transparent
    const active = document.querySelector('.bg-color-btn.active');
    if(active) active.classList.remove('active');
    const transparentBtn = document.querySelector('.bg-color-btn.transparent');
    if(transparentBtn) transparentBtn.classList.add('active');
  }
    const uploadZone = document.getElementById('uploadZone');
    const imageInput = document.getElementById('imageInput');
    const originalPreview = document.getElementById('originalPreview');
    const processedPreview = document.getElementById('processedPreview');
    const processedContainer = document.getElementById('processedContainer');
    const originalCanvas = document.getElementById('originalCanvas');
    const processedCanvas = document.getElementById('processedCanvas');
    const processingSpinner = document.getElementById('processingSpinner');
    const originalPlaceholder = document.getElementById('originalPlaceholder');
    const processedPlaceholder = document.getElementById('processedPlaceholder');
    const downloadBtnEl = document.getElementById('downloadBtn');
    const whatsappShareBtnEl = document.getElementById('whatsappShareBtn');
    const chooseFileBtn = document.getElementById('chooseFileBtn');
    const changeImageBtnEl = document.getElementById('changeImageBtn');
    const targetKbToggleEl = document.getElementById('targetKbToggle');
    const targetKbInputEl = document.getElementById('targetKbInput');
    
    let originalImage = null;
    let currentBgColor = 'transparent';
    let processedImageBlob = null;
    let processingJustCompleted = false; // guard to avoid reopening picker immediately after processing
    let lastUserInteraction = 0; // timestamp of last user pointer interaction
    // track user interactions to allow only user-initiated opens
    try { document.addEventListener('pointerdown', () => { lastUserInteraction = Date.now(); }, { passive: true }); } catch (e) {}

    // Helper: hide upload area on mobile and show a small 'Change Image' control
    function showMobileChangeControl() {
      try {
        const isMobile = window.matchMedia('(max-width: 900px)').matches;
        if (!isMobile) return;

        // Hide the large upload zone
        if (uploadZone) uploadZone.style.display = 'none';

        // Create or show a compact change control near the preview
        let container = document.getElementById('changeUploadContainer');
        if (!container) {
          container = document.createElement('div');
          container.id = 'changeUploadContainer';
          container.style.cssText = 'margin:12px 0; text-align:center;';
          container.innerHTML = '<button id="changeImageBtn" style="padding:10px 14px; border-radius:8px; border:2px solid #3b82f6; background:white; color:#3b82f6; font-weight:700;">Change Image</button>';
          // Insert the control into the left preview column (before processedContainer)
          if (processedContainer && processedContainer.parentNode) {
            processedContainer.parentNode.insertBefore(container, processedContainer);
          } else {
            document.body.appendChild(container);
          }

          const changeBtn = document.getElementById('changeImageBtn');
          if (changeBtn) {
            changeBtn.addEventListener('click', () => {
              if (uploadZone) uploadZone.style.display = 'block';
              if (processingJustCompleted) { console.log('DEBUG: suppressing changeBtn open due to recent processing'); container.style.display = 'none'; return; }
              try { imageInput.click(); } catch (e) { console.warn('open picker failed', e); }
              container.style.display = 'none';
            });
          }
        } else {
          container.style.display = 'block';
        }
      } catch (e) { console.warn('mobile change control failed', e); }
    }

      // Desktop/mobile: wire the existing Change Image button to reopen the upload zone
      try {
        if (changeImageBtnEl) {
          changeImageBtnEl.addEventListener('click', () => {
            if (uploadZone) uploadZone.style.display = 'block';
            const container = document.getElementById('changeUploadContainer');
            if (container) container.style.display = 'none';
            try { imageInput.click(); } catch (e) { console.warn('open picker failed', e); }
          });
        }
      } catch (e) { console.warn('change button wiring failed', e); }

      // Toggle behavior for optional Target KB input
      try {
        if (targetKbToggleEl && targetKbInputEl) {
          // initialize
          targetKbInputEl.style.display = targetKbToggleEl.checked ? 'inline-block' : 'none';
          targetKbToggleEl.addEventListener('change', (e) => {
            targetKbInputEl.style.display = e.target.checked ? 'inline-block' : 'none';
          });
        }
      } catch (e) { console.warn('targetKB toggle wiring failed', e); }

    // processedPreview load handlers removed — original logic uses inline show toggles
    // Use local Flask API with U2-Net (better quality)
    const USE_API = true; // Set to true to enable API-based background removal
    const API_BASE = 'http://localhost:5000'; // Local Flask API base
    const API_HEALTH = API_BASE + '/api/health';
    const API_REMOVE = API_BASE + '/api/remove-background'; // remove endpoint
    let API_AVAILABLE = false;

    // Check API availability (with timeout)
    async function checkApi(timeout = 3000) {
      if (!USE_API) return false;
      try {
        const controller = new AbortController();
        const id = setTimeout(() => controller.abort(), timeout);
        const res = await fetch(API_HEALTH, { method: 'GET', signal: controller.signal });
        clearTimeout(id);
        if (!res.ok) return false;
        const data = await res.json();
        return data && data.status === 'ok';
      } catch (e) {
        console.warn('API health check failed:', e);
        return false;
      }
    }

    // Perform initial API health check
    (async () => {
      if (USE_API) {
        API_AVAILABLE = await checkApi(2000);
        if (!API_AVAILABLE) console.info('API not reachable; falling back to client-side processing.');
        else console.info('API available: using server-side processing');
      }
    })();

    // Hide processing spinner initially
    if (processingSpinner) {
      processingSpinner.style.display = 'none';
    }
    // Disable action buttons until processing completes
    if (downloadBtnEl) downloadBtnEl.disabled = true;
    if (whatsappShareBtnEl) whatsappShareBtnEl.disabled = true;

    // Upload handlers
    uploadZone.addEventListener('click', (e) => {
      console.log('DEBUG: uploadZone clicked');
      // Avoid auto-opening picker right after processing completes
      if (processingJustCompleted) {
        console.log('DEBUG: suppressing uploadZone click due to recent processing');
        return;
      }
      // Allow only if user actually interacted recently (prevents programmatic reopens)
      if (Date.now() - lastUserInteraction > 2000) {
        console.log('DEBUG: suppressing uploadZone open because no recent user interaction');
        return;
      }
      // Always open file picker when upload zone is clicked by user
      try { console.log('DEBUG: attempting imageInput.click()'); imageInput.click(); } catch (err) { console.warn('File input open failed', err); }
    });

    // Fallback choose file button opens file picker too
    if (chooseFileBtn) {
      chooseFileBtn.addEventListener('click', (e) => {
        console.log('DEBUG: chooseFileBtn clicked');
        if (processingJustCompleted) { console.log('DEBUG: suppressing chooseFileBtn click due to recent processing'); return; }
        if (Date.now() - lastUserInteraction > 2000) { console.log('DEBUG: suppressing chooseBtn open because no recent user interaction'); return; }
        try { console.log('DEBUG: attempting imageInput.click() from choose button'); imageInput.click(); } catch (err) { console.warn('Choose file open failed', err); }
      });
    }
    
    uploadZone.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadZone.classList.add('drag-over');
    });

    uploadZone.addEventListener('dragleave', () => {
      uploadZone.classList.remove('drag-over');
    });

    uploadZone.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadZone.classList.remove('drag-over');
      const file = e.dataTransfer.files[0];
        if (file && file.type.startsWith('image/')) {
        // create preview for dropped file
        try {
          if (originalPreview) {
            originalPreview.src = URL.createObjectURL(file);
            try { originalPreview.style.display = 'block'; } catch (e) {}
            try { if (originalPlaceholder) originalPlaceholder.style.display = 'none'; } catch (e) {}
          } else if (processedPreview) {
            processedPreview.src = URL.createObjectURL(file);
            try { processedPreview.style.display = 'block'; } catch (e) {}
            try { if (processedPlaceholder) processedPlaceholder.style.display = 'none'; } catch (e) {}
          }
        } catch (e) {}
        handleImageUpload(file);
      }
    });

    imageInput.addEventListener('change', (e) => {
      console.log('DEBUG: imageInput change fired', e && e.target && e.target.files && e.target.files.length);
      const file = e.target.files[0];
      if (file) {
        console.log('DEBUG: file selected', file.name, file.type, file.size);
        handleImageUpload(file);
        // reset value so same file can be selected again
        try { e.target.value = ''; } catch (err) {}
      }
    });

    

    async function handleImageUpload(file) {
      // upload started
      
      // Show processing spinner, hide placeholders
    if (processingSpinner) {
  processingSpinner.style.display = 'block';
  processingSpinner.innerHTML = '<div class="spinner"></div><p style="color:#64748b;font-weight:600;font-size:15px;">Processing image...<br><span style="font-size:13px;">(Large images may take longer)</span></p>';
}
      if (originalPlaceholder) originalPlaceholder.style.display = 'none';
      if (processedPlaceholder) processedPlaceholder.style.display = 'none';

      // Load original image first
      const reader = new FileReader();
      reader.onload = async (e) => {
        // file read complete
        originalImage = new Image();
        originalImage.onload = async () => {
          // image loaded
          
          // Limit image size for faster processing
let drawWidth = originalImage.width;
let drawHeight = originalImage.height;
const maxDim = 1200;
if (drawWidth > maxDim || drawHeight > maxDim) {
  const scale = Math.min(maxDim / drawWidth, maxDim / drawHeight);
  drawWidth = Math.round(drawWidth * scale);
  drawHeight = Math.round(drawHeight * scale);
  // resizing image if needed
}
        // Show original preview — only mark as visible after it successfully loads
        if (originalPreview) {
          originalPreview.onload = () => {
            try { originalPreview.style.display = 'none'; } catch (e) {}
            if (originalPlaceholder) originalPlaceholder.style.display = 'none';
            // show the single preview (processedPreview) with the uploaded image as a temporary preview
            try {
              if (processedPreview) {
                processedPreview.src = e.target.result;
                processedPreview.style.display = 'block';
                if (processedPlaceholder) processedPlaceholder.style.display = 'none';
              }
            } catch (err) { console.warn('preview fallback failed', err); }
          };
          originalPreview.onerror = () => {
            try { originalPreview.style.display = 'none'; } catch (e) {}
            if (originalPlaceholder) originalPlaceholder.style.display = 'none';
            if (processedPlaceholder) processedPlaceholder.style.display = 'block';
          };
          originalPreview.src = e.target.result;
        } else if (processedPreview) {
          // No original preview element — show uploaded image in the single processed preview
          try {
            processedPreview.src = e.target.result;
            processedPreview.style.display = 'block';
            if (processedPlaceholder) processedPlaceholder.style.display = 'none';
          } catch (err) { console.warn('processed preview set failed', err); }
        }
// Draw on original canvas
originalCanvas.width = drawWidth;
originalCanvas.height = drawHeight;
const octx = originalCanvas.getContext('2d');
octx.drawImage(originalImage, 0, 0, drawWidth, drawHeight);
// canvas drawn

// Immediately show the uploaded image in the single preview box (important for mobile)
try {
  if (processedPreview) {
    processedPreview.src = e.target.result;
    processedPreview.style.display = 'block';
    if (processedPlaceholder) processedPlaceholder.style.display = 'none';
  }
} catch (err) { console.warn('instant preview failed', err); }

// Hide the upload zone (desktop & mobile) and surface the compact change control, then scroll preview into view
try {
  if (uploadZone) uploadZone.style.display = 'none';
  try { showMobileChangeControl(); } catch (e) {}
  try { 
    // show the preview column after upload
    const previewCol = document.getElementById('previewColumn');
    if (previewCol) previewCol.style.setProperty('display','block','important');
  } catch (e) {}
  try { if (processedContainer) processedContainer.scrollIntoView({ behavior: 'smooth', block: 'center' }); } catch (e) {}
} catch (e) { console.warn('preview flow failed', e); }

          // Prefer server-side API if available, otherwise fallback to client-side processing
          if (USE_API && API_AVAILABLE) {
            // attempting U2-Net API
            try {
              const formData = new FormData();
              formData.append('image', file);

              const response = await fetch(API_REMOVE, {
                method: 'POST',
                body: formData
              });

              const result = await response.json();

                if (result && result.success) {
                // U2-Net success
                const base64Data = result.image.split(',')[1];
                const binaryData = atob(base64Data);
                const bytes = new Uint8Array(binaryData.length);
                for (let i = 0; i < binaryData.length; i++) bytes[i] = binaryData.charCodeAt(i);
                processedImageBlob = new Blob([bytes], { type: 'image/png' });
                const url = URL.createObjectURL(processedImageBlob);
                processedPreview.src = url;
                try { processedPreview.style.display = 'block'; } catch (e) {}
                try { if (processedPlaceholder) processedPlaceholder.style.display = 'none'; } catch (e) {}
                  if (processingSpinner) processingSpinner.style.display = 'none';
                  // enable buttons
                  if (downloadBtnEl) downloadBtnEl.disabled = false;
                  if (whatsappShareBtnEl) whatsappShareBtnEl.disabled = false;
                  if (chooseFileBtn) chooseFileBtn.textContent = 'Change Image';
                  try { showMobileChangeControl(); } catch (e) {}
                  // If user hasn't chosen a background, preview it on white by default
                  try {
                    if (currentBgColor === 'transparent') {
                      currentBgColor = 'white';
                      document.querySelectorAll('.bg-color-btn').forEach(b => b.classList.remove('active'));
                      const whiteBtn = document.querySelector('.bg-color-btn[data-color="white"]');
                      if (whiteBtn) whiteBtn.classList.add('active');
                    }
                  } catch (e) {}
                  updateBackground();
                  try { processingJustCompleted = true; setTimeout(() => { processingJustCompleted = false; }, 800); } catch (e) {}
              } else {
                console.error('API returned error:', result && result.error);
                console.info('Falling back to client-side processing');
                processImageClientSide();
                if (processingSpinner) processingSpinner.style.display = 'none';
              }
                } catch (error) {
              console.warn('API request failed, falling back to client-side:', error);
              API_AVAILABLE = false;
              processImageClientSide();
                  if (processingSpinner) processingSpinner.style.display = 'none';
            }
          } else {
            // using client-side processing
            setTimeout(() => {
              try {
                processImageClientSide();
                // processing complete
                if (processingSpinner) processingSpinner.style.display = 'none';
              } catch (error) {
                console.error('Processing error:', error);
                if (processingSpinner) processingSpinner.style.display = 'none';
              }
            }, 500);
          }
        };
        originalImage.onerror = (error) => {
          console.error('Image load error:', error);
          alert('Failed to load image');
          if (processingSpinner) processingSpinner.style.display = 'none';
        };
        originalImage.src = e.target.result;
      };
      reader.onerror = (error) => {
        console.error('File read error:', error);
        alert('Failed to read file');
        if (processingSpinner) processingSpinner.style.display = 'none';
      };
      reader.readAsDataURL(file);
    }

    // Tab switching
    document.querySelectorAll('.bg-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.bg-tab').forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        
        const tabName = tab.dataset.tab;
        if (tabName === 'color') {
          document.getElementById('colorTab').style.display = 'grid';
          document.getElementById('customTab').style.display = 'none';
        } else {
          document.getElementById('colorTab').style.display = 'none';
          document.getElementById('customTab').style.display = 'block';
        }
      });
    });

    // Format button switching
    document.querySelectorAll('.format-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.format-btn').forEach(b => {
          b.style.background = 'white';
          b.style.color = '#64748b';
          b.style.borderColor = '#cbd5e1';
          b.classList.remove('active');
        });
        btn.style.background = 'linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)';
        btn.style.color = 'white';
        btn.style.borderColor = '#3b82f6';
        btn.classList.add('active');
      });
    });

    // Set JPG as default format
    document.querySelector('.format-btn[data-format="jpg"]')?.classList.add('active');

    // Background color selection
    document.querySelectorAll('.bg-color-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.bg-color-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentBgColor = btn.dataset.color;
        updateBackground();
      });
    });

    // Custom color picker
    document.getElementById('customColorPicker').addEventListener('input', (e) => {
      currentBgColor = e.target.value;
      updateBackground();
    });

    function processImageClientSide() {
      console.log('🎨 Starting advanced background removal...');
      if (!originalImage) {
        console.error('❌ No original image!');
        return;
      }

      const width = originalImage.width;
      const height = originalImage.height;
      console.log('📐 Image size:', width, 'x', height);

      // Setup canvases
      originalCanvas.width = width;
      originalCanvas.height = height;
      processedCanvas.width = width;
      processedCanvas.height = height;

      const octx = originalCanvas.getContext('2d');
      const pctx = processedCanvas.getContext('2d');

      octx.drawImage(originalImage, 0, 0);
      pctx.drawImage(originalImage, 0, 0);
      
      const imageData = pctx.getImageData(0, 0, width, height);
      const data = imageData.data;
      const pixels = data.length / 4;
      console.log('✅ Image data loaded:', pixels, 'pixels');

      // STEP 1: Detect background color from all edges
      console.log('🔍 Step 1: Detecting background color...');
      const edgePixels = [];
      const sampleDensity = 5; // Sample every 5 pixels
      
      // Top edge
      for (let x = 0; x < width; x += sampleDensity) {
        const idx = x * 4;
        edgePixels.push([data[idx], data[idx + 1], data[idx + 2]]);
      }
      
      // Bottom edge
      for (let x = 0; x < width; x += sampleDensity) {
        const idx = ((height - 1) * width + x) * 4;
        edgePixels.push([data[idx], data[idx + 1], data[idx + 2]]);
      }
      
      // Left edge
      for (let y = 0; y < height; y += sampleDensity) {
        const idx = (y * width) * 4;
        edgePixels.push([data[idx], data[idx + 1], data[idx + 2]]);
      }
      
      // Right edge
      for (let y = 0; y < height; y += sampleDensity) {
        const idx = (y * width + (width - 1)) * 4;
        edgePixels.push([data[idx], data[idx + 1], data[idx + 2]]);
      }
      
      // Calculate median color (better than average for outliers)
      const rValues = edgePixels.map(p => p[0]).sort((a, b) => a - b);
      const gValues = edgePixels.map(p => p[1]).sort((a, b) => a - b);
      const bValues = edgePixels.map(p => p[2]).sort((a, b) => a - b);
      
      const mid = Math.floor(edgePixels.length / 2);
      const bgR = rValues[mid];
      const bgG = gValues[mid];
      const bgB = bValues[mid];
      
      console.log('🎯 Background color detected:', `rgb(${bgR}, ${bgG}, ${bgB})`);

      // STEP 2: Remove background with gradual transparency
      console.log('🖌️ Step 2: Removing background...');
      const tolerance = 65; // Aggressive removal
      let removedCount = 0;
      
      for (let i = 0; i < data.length; i += 4) {
        const r = data[i];
        const g = data[i + 1];
        const b = data[i + 2];
        
        // Euclidean distance in RGB space
        const distance = Math.sqrt(
          Math.pow(r - bgR, 2) +
          Math.pow(g - bgG, 2) +
          Math.pow(b - bgB, 2)
        );
        
        // Gradual transparency based on distance
        if (distance < tolerance) {
          // Complete transparency for very close colors
          if (distance < tolerance * 0.4) {
            data[i + 3] = 0;
            removedCount++;
          } else {
            // Gradual fade for edge pixels
            const ratio = (distance - tolerance * 0.4) / (tolerance * 0.6);
            data[i + 3] = Math.floor(ratio * 255);
          }
        }
      }
      
      console.log('✨ Background removed:', removedCount, 'pixels (', Math.round(removedCount / pixels * 100), '%)');

      // STEP 3: Edge refinement for smooth borders
      console.log('🔧 Step 3: Refining edges...');
      const tempData = new Uint8ClampedArray(data);
      
      for (let y = 1; y < height - 1; y++) {
        for (let x = 1; x < width - 1; x++) {
          const idx = (y * width + x) * 4;
          
          // Skip if fully transparent or opaque
          if (tempData[idx + 3] === 0 || tempData[idx + 3] === 255) continue;
          
          // Check 8 neighbors
          let transparentNeighbors = 0;
          for (let dy = -1; dy <= 1; dy++) {
            for (let dx = -1; dx <= 1; dx++) {
              if (dx === 0 && dy === 0) continue;
              const nIdx = ((y + dy) * width + (x + dx)) * 4;
              if (tempData[nIdx + 3] < 128) transparentNeighbors++;
            }
          }
          
          // Smooth edge pixels based on neighbors
          if (transparentNeighbors > 3) {
            const edgeFactor = 1 - (transparentNeighbors / 8);
            data[idx + 3] = Math.floor(tempData[idx + 3] * edgeFactor);
          }
        }
      }
      
      console.log('✅ Edge refinement complete');

      // STEP 4: Apply to canvas and create blob
      pctx.putImageData(imageData, 0, 0);
      
      processedCanvas.toBlob((blob) => {
        if (blob) {
          processedImageBlob = blob;
          const url = URL.createObjectURL(blob);
          processedPreview.src = url;
          try { processedPreview.style.display = 'block'; } catch (e) {}
          try { if (processedPlaceholder) processedPlaceholder.style.display = 'none'; } catch (e) {}
          console.log('🎉 Processing complete! Blob size:', (blob.size / 1024).toFixed(2), 'KB');
          // enable action buttons
          if (downloadBtnEl) downloadBtnEl.disabled = false;
          if (whatsappShareBtnEl) whatsappShareBtnEl.disabled = false;
          if (chooseFileBtn) chooseFileBtn.textContent = 'Change Image';
          try { showMobileChangeControl(); } catch (e) {}
          // If user hasn't chosen a background, preview it on white by default
          try {
            if (currentBgColor === 'transparent') {
              currentBgColor = 'white';
              document.querySelectorAll('.bg-color-btn').forEach(b => b.classList.remove('active'));
              const whiteBtn = document.querySelector('.bg-color-btn[data-color="white"]');
              if (whiteBtn) whiteBtn.classList.add('active');
            }
          } catch (e) {}
          updateBackground();
          try { processingJustCompleted = true; setTimeout(() => { processingJustCompleted = false; }, 800); } catch (e) {}
        } else {
          console.error('❌ Failed to create blob');
        }
      }, 'image/png');
    }

    const gradients = {
      'gradient1': 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
      'gradient2': 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
      'gradient3': 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
      'gradient4': 'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)',
      'gradient5': 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',
      'gradient6': 'linear-gradient(135deg, #30cfd0 0%, #330867 100%)'
    };

    function updateBackground() {
      // Configure processed container layout
      processedContainer.style.minHeight = 'unset';
      processedContainer.style.display = 'flex';
      processedContainer.style.alignItems = 'center';
      processedContainer.style.justifyContent = 'center';
      processedContainer.style.borderRadius = '12px';
      processedContainer.style.maxWidth = '260px';
      processedContainer.style.maxHeight = '320px';
      // Default: no checker class (will be added for transparent backgrounds)
      try { processedContainer.classList.remove('checker'); } catch (e) {}
      // Get the transparent image source (declare only once)
      let transparentSource = processedImageBlob || (processedCanvas.width > 0 ? processedCanvas : null);
      if (!transparentSource) return;

      if (currentBgColor === 'transparent') {
        // Show checkerboard background and padding so transparency is visible
        try { processedContainer.classList.add('checker'); } catch (e) {}
        processedContainer.style.padding = '10px';
        processedContainer.style.border = '1px solid rgba(0,0,0,0.06)';
        if (processedImageBlob) {
          processedPreview.src = URL.createObjectURL(processedImageBlob);
          try { processedPreview.style.display = 'block'; } catch (e) {}
          try { if (processedPlaceholder) processedPlaceholder.style.display = 'none'; } catch (e) {}
        } else if (processedCanvas.width > 0) {
          processedCanvas.toBlob((blob) => {
            processedPreview.src = URL.createObjectURL(blob);
            try { processedPreview.style.display = 'block'; } catch (e) {}
            try { if (processedPlaceholder) processedPlaceholder.style.display = 'none'; } catch (e) {}
          }, 'image/png');
        }
      } else {
        // Draw color/gradient only behind the image, no extra box
        const img = new Image();
        img.crossOrigin = 'anonymous';
        img.onload = () => {
          const canvas = document.createElement('canvas');
          canvas.width = img.width;
          canvas.height = img.height;
          const ctx = canvas.getContext('2d');
          // Fill background
          let isGradient = currentBgColor.startsWith('gradient');
          let bgStyle = isGradient ? gradients[currentBgColor] : currentBgColor;
          if (isGradient) {
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            const gradientColors = bgStyle.match(/#[0-9a-f]{6}/gi);
            if (gradientColors && gradientColors.length >= 2) {
              gradient.addColorStop(0, gradientColors[0]);
              gradient.addColorStop(1, gradientColors[1]);
              ctx.fillStyle = gradient;
            } else {
              ctx.fillStyle = currentBgColor;
            }
          } else {
            ctx.fillStyle = currentBgColor;
          }
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          // Draw transparent image on top
          ctx.drawImage(img, 0, 0);
          // Update preview
          processedPreview.src = canvas.toDataURL('image/png');
          try { processedPreview.style.display = 'block'; } catch (e) {}
          try { if (processedPlaceholder) processedPlaceholder.style.display = 'none'; } catch (e) {}
        };
        if (processedImageBlob) {
          img.src = URL.createObjectURL(processedImageBlob);
        } else if (processedCanvas.width > 0) {
          img.src = processedCanvas.toDataURL('image/png');
        }
      }
    }
    // Utility: compress canvas to target KB (simple iterative quality reduction)
    async function compressCanvasToTargetKB(canvas, targetKB, mimeType = 'image/jpeg') {
      return new Promise((resolve) => {
        if (!targetKB || targetKB <= 0 || mimeType !== 'image/jpeg') {
          canvas.toBlob((b) => resolve(b), mimeType, 0.95);
          return;
        }
        const targetBytes = targetKB * 1024;
        let quality = 0.95;
        let attempts = 0;

        const tryCompress = () => {
          canvas.toBlob((b) => {
            if (!b) return resolve(null);
            if (b.size <= targetBytes || attempts >= 10 || quality <= 0.12) return resolve(b);
            // reduce quality and retry
            attempts++;
            quality = Math.max(quality - 0.12, 0.08);
            tryCompress();
          }, mimeType, quality);
        };

        tryCompress();
      });
    }

    // Download button (uses optional KB target when JPG chosen)
    if (downloadBtnEl) {
      downloadBtnEl.addEventListener('click', async () => {
        const transparentSource = processedImageBlob || (processedCanvas.width > 0 ? processedCanvas : null);
        if (!transparentSource) return;

        const selectedFmt = (document.querySelector('.format-btn[data-format].active')?.dataset.format) || (document.querySelector('.format-btn[data-format]')?.dataset.format) || 'jpg';
        const targetKb = (document.getElementById('targetKbToggle')?.checked) ? (parseInt(document.getElementById('targetKbInput')?.value || '0', 10) || 0) : 0;

        const img = new Image();
        img.crossOrigin = 'anonymous';

        img.onload = async () => {
          const finalCanvas = document.createElement('canvas');
          finalCanvas.width = img.width;
          finalCanvas.height = img.height;
          const fctx = finalCanvas.getContext('2d');

          if (currentBgColor !== 'transparent') {
            fctx.fillStyle = currentBgColor;
            fctx.fillRect(0, 0, finalCanvas.width, finalCanvas.height);
          }
          fctx.drawImage(img, 0, 0);

          // If JPG and targetKB provided, attempt compression
          if (selectedFmt === 'jpg' && targetKb > 0) {
            const blob = await compressCanvasToTargetKB(finalCanvas, targetKb, 'image/jpeg');
            if (blob) {
              const url = URL.createObjectURL(blob);
              const a = document.createElement('a');
              a.href = url;
              a.download = appendBrand(currentBgColor === 'transparent' ? `background-removed-transparent.jpg` : `background-removed.jpg`);
              a.click();
              return;
            }
          }

          // Default behavior: export normally
          finalCanvas.toBlob((blob) => {
            if (!blob) return;
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            const extension = selectedFmt === 'png' ? 'png' : 'jpg';
            a.download = appendBrand(currentBgColor === 'transparent' ? `background-removed-transparent.${extension}` : `background-removed.${extension}`);
            a.click();
          }, selectedFmt === 'png' ? 'image/png' : 'image/jpeg', 0.95);
        };

        if (processedImageBlob) {
          img.src = URL.createObjectURL(processedImageBlob);
        } else if (processedCanvas.width > 0) {
          img.src = processedCanvas.toDataURL('image/png');
        }
      });
    }

    // WhatsApp Share button
    document.getElementById('whatsappShareBtn').addEventListener('click', async () => {
      const transparentSource = processedImageBlob || (processedCanvas.width > 0 ? processedCanvas : null);
      if (!transparentSource) return;

      const img = new Image();
      img.crossOrigin = 'anonymous';
      
      img.onload = () => {
        const finalCanvas = document.createElement('canvas');
        finalCanvas.width = img.width;
        finalCanvas.height = img.height;
        const fctx = finalCanvas.getContext('2d');

        if (currentBgColor !== 'transparent') {
          fctx.fillStyle = currentBgColor;
          fctx.fillRect(0, 0, finalCanvas.width, finalCanvas.height);
        }

        fctx.drawImage(img, 0, 0);

        finalCanvas.toBlob(async (blob) => {
          try {
            const fileName = currentBgColor === 'transparent' ? 'background-removed-transparent.png' : 'background-removed-colored.png';
            const file = new File([blob], fileName, { type: 'image/png' });
            
            if (navigator.canShare && navigator.canShare({ files: [file] })) {
              await navigator.share({
                files: [file],
                title: 'Background Removed Photo',
                text: 'Check out my background removed photo from GS DocSeva!'
              });
            } else {
              const url = URL.createObjectURL(blob);
              const a = document.createElement('a');
              a.href = url;
              a.download = appendBrand(fileName);
              a.click();
              
              const message = 'I removed background from my photo using GS DocSeva! Check it out at https://resizegovform.netlify.app';
              const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
              window.open(whatsappUrl, '_blank');
            }
          } catch (error) {
            console.error('Share error:', error);
          }
        }, 'image/png');
      };

      if (processedImageBlob) {
        img.src = URL.createObjectURL(processedImageBlob);
      } else if (processedCanvas.width > 0) {
        img.src = processedCanvas.toDataURL('image/png');
      }
    });
  </script>
  
<script>
  // Navigation toggle
  const navToggle = document.querySelector('.nav-toggle');
  const navLinks = document.querySelector('.nav-links');
  
  if (navToggle) {
    navToggle.addEventListener('click', () => {
      navLinks.classList.toggle('active');
    });

    navLinks.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', () => {
        navLinks.classList.remove('active');
      });
    });
  }
</script>

</body>
</html>